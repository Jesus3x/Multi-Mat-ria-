<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cl√≠nica3 Digital Pro - Consultas Online</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-database-compat.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');
        
        * {
            font-family: 'Inter', sans-serif;
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }
        
        .service-card {
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }
        
        .service-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 25px 50px rgba(0,0,0,0.2);
        }
        
        .medical-service-btn {
            position: relative;
            padding: 12px;
            border-radius: 12px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            overflow: hidden;
            min-height: 100px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: center;
            text-align: center;
            color: white;
        }
        
        .medical-service-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        }
        
        .medical-service-btn:active {
            transform: translateY(0);
        }
        
        /* New Wide Button Styles */
        .medical-service-btn-wide {
            position: relative;
            padding: 16px 20px;
            border-radius: 16px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            width: 100%;
            height: 80px;
            display: flex;
            align-items: center;
            text-align: left;
            color: #1f2937;
            background: white;
        }
        
        .medical-service-btn-wide:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.15);
        }
        
        .medical-service-btn-wide:active {
            transform: translateY(-1px);
        }
        
        .service-icon-left {
            flex-shrink: 0;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 16px;
            background: linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%);
            border-radius: 12px;
            border: 2px solid #e5e7eb;
        }
        
        .service-content-wide {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            min-width: 0;
        }
        
        .service-title-wide {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 4px;
            line-height: 1.2;
            color: #111827;
        }
        
        .service-desc-wide {
            font-size: 14px;
            opacity: 0.7;
            line-height: 1.3;
            color: #4b5563;
        }
        
        .service-status-wide {
            flex-shrink: 0;
            display: flex;
            align-items: center;
            gap: 8px;
            margin-left: 16px;
        }
        
        .status-text-wide {
            font-size: 12px;
            font-weight: 600;
            color: #059669;
        }
        
        .service-icon {
            margin-bottom: 8px;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
        }
        
        .service-icon img {
            width: 32px;
            height: 32px;
            object-fit: contain;
        }
        
        .service-info {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            margin-bottom: 8px;
        }
        
        .service-title {
            font-size: 14px;
            font-weight: 700;
            margin-bottom: 4px;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
            line-height: 1.2;
        }
        
        .service-desc {
            font-size: 11px;
            opacity: 0.9;
            line-height: 1.3;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
        }
        
        .service-status {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 4px;
            margin-top: auto;
        }
        
        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            animation: pulse-dot 2s infinite;
        }
        
        .status-text {
            font-size: 10px;
            font-weight: 600;
            opacity: 0.9;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
        }
        
        @keyframes pulse-dot {
            0% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.2); }
            100% { opacity: 1; transform: scale(1); }
        }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
            .medical-service-btn {
                min-height: 90px;
                padding: 10px;
            }
            
            .service-title {
                font-size: 12px;
            }
            
            .service-desc {
                font-size: 10px;
            }
            
            .service-icon span {
                font-size: 20px;
            }
            
            /* Wide button responsive */
            .medical-service-btn-wide {
                height: 70px;
                padding: 12px 16px;
            }
            
            .service-icon-left {
                width: 50px;
                height: 50px;
                margin-right: 12px;
            }
            
            .service-icon-left span {
                font-size: 24px;
            }
            
            .service-title-wide {
                font-size: 16px;
            }
            
            .service-desc-wide {
                font-size: 12px;
            }
            
            .status-text-wide {
                font-size: 11px;
            }
        }
        
        @media (max-width: 640px) {
            .medical-service-btn {
                min-height: 80px;
                padding: 8px;
            }
            
            .service-title {
                font-size: 11px;
            }
            
            .service-desc {
                font-size: 9px;
            }
            
            .service-icon span {
                font-size: 18px;
            }
            
            /* Wide button mobile */
            .medical-service-btn-wide {
                height: 65px;
                padding: 10px 14px;
            }
            
            .service-icon-left {
                width: 45px;
                height: 45px;
                margin-right: 10px;
            }
            
            .service-icon-left span {
                font-size: 20px;
            }
            
            .service-title-wide {
                font-size: 14px;
            }
            
            .service-desc-wide {
                font-size: 11px;
            }
            
            .service-status-wide {
                margin-left: 8px;
            }
            
            .status-text-wide {
                font-size: 10px;
            }
        }
        
        .chat-container {
            position: fixed;
            top: 50%;
            right: 20px;
            width: 320px;
            height: 480px;
            z-index: 999;
            transform: translateY(-50%) translateX(100vw);
            transition: transform 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        
        .chat-container.open {
            transform: translateY(-50%) translateX(0);
        }
        
        .auto-chat-container {
            position: fixed;
            top: 50%;
            left: 20px;
            width: 320px;
            height: 480px;
            z-index: 999;
            transform: translateY(-50%) translateX(-100vw);
            transition: transform 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        
        .auto-chat-container.open {
            transform: translateY(-50%) translateX(0);
        }
        
        .consultation-container {
            position: fixed;
            top: 50%;
            left: 50%;
            width: 360px;
            height: 500px;
            z-index: 999;
            transform: translateX(-50%) translateY(-50%) scale(0);
            transition: transform 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        
        .consultation-container.open {
            transform: translateX(-50%) translateY(-50%) scale(1);
        }
        
        .pharmacy-container {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 360px;
            height: 520px;
            z-index: 999;
            transform: translateY(-100vh);
            transition: transform 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        
        .pharmacy-container.open {
            transform: translateY(0);
        }
        
        .nutrition-container {
            position: fixed;
            top: 50%;
            left: 50%;
            width: 400px;
            height: 550px;
            z-index: 999;
            transform: translateX(-50%) translateY(-50%) scale(0);
            transition: transform 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        
        .nutrition-container.open {
            transform: translateX(-50%) translateY(-50%) scale(1);
        }
        
        .addiction-container {
            position: fixed;
            top: 50%;
            left: 50%;
            width: 400px;
            height: 550px;
            z-index: 999;
            transform: translateX(-50%) translateY(-50%) scale(0);
            transition: transform 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        
        .addiction-container.open {
            transform: translateX(-50%) translateY(-50%) scale(1);
        }
        
        .message-bubble {
            animation: slideIn 0.3s ease;
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .recording {
            animation: recordPulse 1s infinite;
        }
        
        @keyframes recordPulse {
            0% { background-color: #ef4444; }
            50% { background-color: #dc2626; }
            100% { background-color: #ef4444; }
        }
        
        .hero-text {
            animation: fadeInUp 1s ease;
        }
        
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .services-grid {
            animation: fadeIn 1.2s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 9999;
            transform: translateX(400px);
            transition: transform 0.3s ease;
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .video-player {
            position: relative;
            width: 100%;
            height: 200px;
            background: #000;
            border-radius: 8px;
            overflow: hidden;
        }
    </style>
</head>
<body class="bg-gray-900 text-white">
    <!-- Notification Container -->
    <div id="notificationContainer"></div>

    <!-- Header -->
    <header class="bg-gradient-to-r from-blue-900 via-teal-800 to-green-800 py-4 px-4 shadow-2xl border-b-4 border-blue-300">
        <div class="max-w-7xl mx-auto">
            <!-- Top Row: Logo and Navigation -->
            <div class="flex justify-between items-center mb-4">
                <div class="flex items-center space-x-3">
                    <div class="w-12 h-12 bg-white rounded-full flex items-center justify-center shadow-lg">
                        <span class="text-2xl">üè•</span>
                    </div>
                    <div>
                        <h1 class="text-2xl font-bold text-white">Cl√≠nica Digital Pro</h1>
                        <p class="text-sm text-blue-200">Cuidados m√©dicos inteligentes</p>
                    </div>
                </div>
                <nav class="flex flex-wrap items-center space-x-4 md:space-x-6">
                    <button type="button" onclick="scrollToServices()" class="hover:text-blue-200 transition text-sm md:text-base text-white cursor-pointer">Servi√ßos</button>
                    <button type="button" onclick="scrollToServices()" class="hover:text-blue-200 transition text-sm md:text-base text-white cursor-pointer">Consultas</button>
                    <button type="button" onclick="alert('Em breve!')" class="hover:text-blue-200 transition text-sm md:text-base hidden md:inline text-white cursor-pointer">Sobre</button>
                    <button type="button" onclick="alert('Em breve!')" class="hover:text-blue-200 transition text-sm md:text-base hidden md:inline text-white cursor-pointer">Contato</button>
                </nav>
            </div>
            
            <!-- Medical Services Row - Vertical Stack -->
            <div class="flex flex-col gap-2 max-w-4xl mx-auto">
                <!-- Pharmacy Finder Button -->
                <button type="button" onclick="togglePharmacyFinder()" class="medical-service-btn-wide bg-white hover:bg-gray-50 text-gray-800 border-2 border-gray-200 hover:border-orange-400 shadow-lg hover:shadow-xl cursor-pointer">
                    <div class="service-icon-left">
                        <span class="text-3xl">üíä</span>
                    </div>
                    <div class="service-content-wide">
                        <h3 class="service-title-wide">Farm√°cias Pr√≥ximas</h3>
                        <p class="service-desc-wide">Encontre medicamentos e farm√°cias na sua regi√£o</p>
                    </div>
                    <div class="service-status-wide">
                        <span class="status-dot bg-green-500"></span>
                        <span class="status-text-wide">Online</span>
                    </div>
                </button>
                
                <!-- Auto Support Chat Button -->
                <button type="button" onclick="toggleAutoChat()" class="medical-service-btn-wide bg-white hover:bg-gray-50 text-gray-800 border-2 border-gray-200 hover:border-emerald-400 shadow-lg hover:shadow-xl cursor-pointer">
                    <div class="service-icon-left">
                        <span class="text-3xl">ü§ñ</span>
                    </div>
                    <div class="service-content-wide">
                        <h3 class="service-title-wide">Autoatendimento Virtual</h3>
                        <p class="service-desc-wide">Assistente m√©dico virtual especializado</p>
                    </div>
                    <div class="service-status-wide">
                        <span class="status-dot bg-green-500"></span>
                        <span class="status-text-wide">Online</span>
                    </div>
                </button>
                
                <!-- Consultation Rooms Button -->
                <button type="button" onclick="toggleConsultation()" class="medical-service-btn-wide bg-white hover:bg-gray-50 text-gray-800 border-2 border-gray-200 hover:border-indigo-400 shadow-lg hover:shadow-xl cursor-pointer">
                    <div class="service-icon-left">
                        <span class="text-3xl">üè•</span>
                    </div>
                    <div class="service-content-wide">
                        <h3 class="service-title-wide">Salas de Consulta Especializadas</h3>
                        <p class="service-desc-wide">M√©dicos especialistas online agora mesmo</p>
                    </div>
                    <div class="service-status-wide">
                        <span class="status-dot bg-green-500"></span>
                        <span class="status-text-wide">3 M√©dicos</span>
                    </div>
                </button>
                
                <!-- Live Chat Button -->
                <button type="button" onclick="toggleChat()" class="medical-service-btn-wide bg-white hover:bg-gray-50 text-gray-800 border-2 border-gray-200 hover:border-blue-400 shadow-lg hover:shadow-xl cursor-pointer">
                    <div class="service-icon-left">
                        <span class="text-3xl">üí¨</span>
                    </div>
                    <div class="service-content-wide">
                        <h3 class="service-title-wide">Chat ao Vivo M√©dico</h3>
                        <p class="service-desc-wide">Suporte m√©dico em tempo real com profissionais</p>
                    </div>
                    <div class="service-status-wide">
                        <span class="status-dot bg-green-500"></span>
                        <span class="status-text-wide">2 Online</span>
                    </div>
                </button>
                
                <!-- Nutrition Chat Button -->
                <button type="button" onclick="toggleNutritionChat()" class="medical-service-btn-wide bg-white hover:bg-gray-50 text-gray-800 border-2 border-gray-200 hover:border-lime-400 shadow-lg hover:shadow-xl cursor-pointer">
                    <div class="service-icon-left">
                        <span class="text-3xl">ü•ó</span>
                    </div>
                    <div class="service-content-wide">
                        <h3 class="service-title-wide">Dr. Nutricionista</h3>
                        <p class="service-desc-wide">Orienta√ß√£o nutricional personalizada</p>
                    </div>
                    <div class="service-status-wide">
                        <span class="status-dot bg-green-500"></span>
                        <span class="status-text-wide">Dispon√≠vel</span>
                    </div>
                </button>
                
                <!-- Psychology Chat Button -->
                <button type="button" onclick="togglePsychologyChat()" class="medical-service-btn-wide bg-white hover:bg-gray-50 text-gray-800 border-2 border-gray-200 hover:border-pink-400 shadow-lg hover:shadow-xl cursor-pointer">
                    <div class="service-icon-left">
                        <span class="text-3xl">üß†</span>
                    </div>
                    <div class="service-content-wide">
                        <h3 class="service-title-wide">Dr. Psic√≥logo</h3>
                        <p class="service-desc-wide">Especialista em v√≠cios e sa√∫de mental</p>
                    </div>
                    <div class="service-status-wide">
                        <span class="status-dot bg-green-500"></span>
                        <span class="status-text-wide">Ativo</span>
                    </div>
                </button>
            </div>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="gradient-bg py-20 px-4">
        <div class="max-w-4xl mx-auto text-center hero-text">
            <h2 class="text-5xl font-bold mb-6">Cuidados M√©dicos Inteligentes</h2>
            <p class="text-xl mb-8 opacity-90">Consultas online com IA avan√ßada e especialistas qualificados</p>
            <button type="button" onclick="scrollToServices()" class="bg-white text-green-600 px-8 py-4 rounded-full font-semibold hover:bg-gray-100 transition transform hover:scale-105 cursor-pointer">
                Explorar Servi√ßos
            </button>
        </div>
    </section>

    <!-- AI Diagnosis Section -->
    <section class="py-20 px-4 bg-gray-800">
        <div class="max-w-4xl mx-auto text-center">
            <h3 class="text-4xl font-bold mb-8">ü§ñ Diagn√≥stico com IA</h3>
            <p class="text-xl mb-8 text-gray-300">Descreva seus sintomas e receba uma an√°lise preliminar com IA Gemini</p>
            
            <div class="bg-gray-900 rounded-2xl p-8 max-w-2xl mx-auto">
                <div class="mb-6">
                    <textarea 
                        id="symptomsInput" 
                        placeholder="Descreva seus sintomas detalhadamente..."
                        class="w-full bg-gray-800 p-4 rounded-xl text-white focus:outline-none focus:ring-2 focus:ring-green-500 border border-gray-600 h-32 resize-none"
                    ></textarea>
                </div>
                
                <button 
                    type="button"
                    onclick="analyzeSymptoms()" 
                    id="analyzeBtn"
                    class="w-full bg-gradient-to-r from-green-500 to-emerald-600 py-4 rounded-xl font-semibold hover:from-green-600 hover:to-emerald-700 transition transform hover:scale-105 cursor-pointer"
                >
                    üîç Analisar Sintomas
                </button>
                
                <div id="diagnosisResult" class="mt-6 hidden">
                    <div class="bg-green-900 bg-opacity-50 rounded-xl p-6">
                        <h4 class="text-xl font-bold mb-4 text-green-300">üìã An√°lise Preliminar</h4>
                        <p id="diagnosisText" class="text-gray-200 mb-4"></p>
                    </div>
                </div>
                
                <!-- Se√ß√£o de V√≠deos Educativos - AQUI √â ONDE OS V√çDEOS DEVEM APARECER -->
                <div id="videoSection" class="mt-6 hidden">
                    <!-- Os v√≠deos ser√£o inseridos aqui pelo JavaScript -->
                </div>
            </div>
        </div>
    </section>

    <!-- Services Section -->
    <section id="services" class="py-20 px-4">
        <div class="max-w-6xl mx-auto">
            <h3 class="text-4xl font-bold text-center mb-16">Nossos Servi√ßos</h3>
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8 services-grid">
                <!-- Service 1 -->
                <div class="service-card bg-gray-800 rounded-2xl p-6 border border-gray-700">
                    <div class="w-20 h-20 bg-gradient-to-r from-green-500 to-emerald-600 rounded-2xl mb-4 flex items-center justify-center text-3xl">
                        ü©∫
                    </div>
                    <h4 class="text-2xl font-bold mb-3">Cl√≠nica Geral</h4>
                    <p class="text-gray-300 mb-6">Consultas gerais, check-ups e acompanhamento m√©dico completo</p>
                    <div class="flex justify-between items-center mb-4">
                        <span class="text-2xl font-bold text-green-400">R$ 89,90</span>
                        <div class="flex text-yellow-400">
                            ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê
                        </div>
                    </div>
                    <button type="button" onclick="alert('Consulta de Cl√≠nica Geral - R$ 89,90 - Em breve!')" class="w-full bg-gradient-to-r from-green-500 to-emerald-600 py-3 rounded-xl font-semibold hover:from-green-600 hover:to-emerald-700 transition cursor-pointer">
                        Agendar Consulta
                    </button>
                </div>

                <!-- Service 2 -->
                <div class="service-card bg-gray-800 rounded-2xl p-6 border border-gray-700">
                    <div class="w-20 h-20 bg-gradient-to-r from-red-500 to-pink-600 rounded-2xl mb-4 flex items-center justify-center text-3xl">
                        ‚ù§Ô∏è
                    </div>
                    <h4 class="text-2xl font-bold mb-3">Cardiologia</h4>
                    <p class="text-gray-300 mb-6">Especialista em cora√ß√£o, press√£o arterial e doen√ßas cardiovasculares</p>
                    <div class="flex justify-between items-center mb-4">
                        <span class="text-2xl font-bold text-green-400">R$ 149,90</span>
                        <div class="flex text-yellow-400">
                            ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê
                        </div>
                    </div>
                    <button type="button" onclick="alert('Consulta de Cardiologia - R$ 149,90 - Em breve!')" class="w-full bg-gradient-to-r from-red-500 to-pink-600 py-3 rounded-xl font-semibold hover:from-red-600 hover:to-pink-700 transition cursor-pointer">
                        Agendar Consulta
                    </button>
                </div>

                <!-- Service 3 -->
                <div class="service-card bg-gray-800 rounded-2xl p-6 border border-gray-700">
                    <div class="w-20 h-20 bg-gradient-to-r from-blue-500 to-cyan-600 rounded-2xl mb-4 flex items-center justify-center text-3xl">
                        üß¥
                    </div>
                    <h4 class="text-2xl font-bold mb-3">Dermatologia</h4>
                    <p class="text-gray-300 mb-6">Cuidados com a pele, cabelo e tratamentos dermatol√≥gicos</p>
                    <div class="flex justify-between items-center mb-4">
                        <span class="text-2xl font-bold text-green-400">R$ 129,90</span>
                        <div class="flex text-yellow-400">
                            ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê
                        </div>
                    </div>
                    <button type="button" onclick="alert('Consulta de Dermatologia - R$ 129,90 - Em breve!')" class="w-full bg-gradient-to-r from-blue-500 to-cyan-600 py-3 rounded-xl font-semibold hover:from-blue-600 hover:to-cyan-700 transition cursor-pointer">
                        Agendar Consulta
                    </button>
                </div>

                <!-- Service 4 -->
                <div class="service-card bg-gray-800 rounded-2xl p-6 border border-gray-700">
                    <div class="w-20 h-20 bg-gradient-to-r from-purple-500 to-indigo-600 rounded-2xl mb-4 flex items-center justify-center text-3xl">
                        üß†
                    </div>
                    <h4 class="text-2xl font-bold mb-3">Psicologia</h4>
                    <p class="text-gray-300 mb-6">Terapia online, ansiedade, depress√£o e bem-estar mental</p>
                    <div class="flex justify-between items-center mb-4">
                        <span class="text-2xl font-bold text-green-400">R$ 119,90</span>
                        <div class="flex text-yellow-400">
                            ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê
                        </div>
                    </div>
                    <button type="button" onclick="alert('Consulta de Psicologia - R$ 119,90 - Em breve!')" class="w-full bg-gradient-to-r from-purple-500 to-indigo-600 py-3 rounded-xl font-semibold hover:from-purple-600 hover:to-indigo-700 transition cursor-pointer">
                        Agendar Consulta
                    </button>
                </div>

                <!-- Service 5 -->
                <div class="service-card bg-gray-800 rounded-2xl p-6 border border-gray-700">
                    <div class="w-20 h-20 bg-gradient-to-r from-yellow-500 to-orange-600 rounded-2xl mb-4 flex items-center justify-center text-3xl">
                        üë∂
                    </div>
                    <h4 class="text-2xl font-bold mb-3">Pediatria</h4>
                    <p class="text-gray-300 mb-6">Cuidados especializados para beb√™s, crian√ßas e adolescentes</p>
                    <div class="flex justify-between items-center mb-4">
                        <span class="text-2xl font-bold text-green-400">R$ 109,90</span>
                        <div class="flex text-yellow-400">
                            ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê
                        </div>
                    </div>
                    <button type="button" onclick="alert('Consulta de Pediatria - R$ 109,90 - Em breve!')" class="w-full bg-gradient-to-r from-yellow-500 to-orange-600 py-3 rounded-xl font-semibold hover:from-yellow-600 hover:to-orange-700 transition cursor-pointer">
                        Agendar Consulta
                    </button>
                </div>

                <!-- Service 6 -->
                <div class="service-card bg-gray-800 rounded-2xl p-6 border border-gray-700">
                    <div class="w-20 h-20 bg-gradient-to-r from-teal-500 to-green-600 rounded-2xl mb-4 flex items-center justify-center text-3xl">
                        üíä
                    </div>
                    <h4 class="text-2xl font-bold mb-3">Farm√°cia Online</h4>
                    <p class="text-gray-300 mb-6">Medicamentos com receita digital e entrega em domic√≠lio</p>
                    <div class="flex justify-between items-center mb-4">
                        <span class="text-2xl font-bold text-green-400">Consulte</span>
                        <div class="flex text-yellow-400">
                            ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê
                        </div>
                    </div>
                    <button type="button" onclick="alert('Farm√°cia Online - Em breve!')" class="w-full bg-gradient-to-r from-teal-500 to-green-600 py-3 rounded-xl font-semibold hover:from-teal-600 hover:to-green-700 transition cursor-pointer">
                        Ver Medicamentos
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-gray-800 py-12 px-4">
        <div class="max-w-6xl mx-auto text-center">
            <h4 class="text-2xl font-bold mb-4">Cl√≠nica Digital Pro</h4>
            <p class="text-gray-400 mb-6">Cuidando da sua sa√∫de com tecnologia e humaniza√ß√£o</p>
            <div class="flex justify-center space-x-6">
                <a href="#" class="text-gray-400 hover:text-white transition">üìß contato@clinicadigital.com</a>
                <a href="#" class="text-gray-400 hover:text-white transition">üì± (11) 99999-9999</a>
                <a href="#" class="text-gray-400 hover:text-white transition">üè• Emerg√™ncia 24h</a>
            </div>
        </div>
    </footer>

    <!-- Auto Support Chat Container (Left) -->
    <div id="autoChatContainer" class="auto-chat-container bg-gray-900 rounded-2xl shadow-2xl border border-gray-600">
        <!-- Auto Chat Header -->
        <div class="bg-gradient-to-r from-green-500 to-teal-600 p-4 rounded-t-2xl flex justify-between items-center">
            <div class="flex items-center space-x-3">
                <div class="w-10 h-10 bg-white rounded-full flex items-center justify-center">
                    ü§ñ
                </div>
                <div>
                    <h5 class="font-semibold">Autoatendimento</h5>
                    <p class="text-sm opacity-80">Respostas m√©dicas instant√¢neas</p>
                </div>
            </div>
            <button onclick="toggleAutoChat()" class="text-white hover:bg-white hover:bg-opacity-20 p-2 rounded-full transition">
                ‚úï
            </button>
        </div>

        <!-- Auto Status Panel -->
        <div class="p-3 bg-green-900 bg-opacity-80 border-b border-gray-600">
            <p class="text-sm text-green-200 flex items-center">
                <span class="w-2 h-2 bg-green-400 rounded-full mr-2 animate-pulse"></span>
                Assistente m√©dico online
            </p>
        </div>

        <!-- Auto Messages Area -->
        <div id="autoMessagesArea" class="flex-1 p-4 overflow-y-auto h-64 space-y-3">
            <div class="message-bubble bg-gray-700 p-3 rounded-xl max-w-xs">
                <p class="text-sm">üëã Ol√°! Sou seu assistente m√©dico virtual. Como posso ajudar?</p>
                <span class="text-xs text-gray-400">Bot ‚Ä¢ agora</span>
            </div>
            <div class="message-bubble bg-gray-700 p-3 rounded-xl max-w-xs">
                <p class="text-sm">ü©∫ Voc√™ pode perguntar sobre:</p>
                <ul class="text-xs mt-2 space-y-1">
                    <li>‚Ä¢ Sintomas e doen√ßas</li>
                    <li>‚Ä¢ Hor√°rios de consulta</li>
                    <li>‚Ä¢ Especialidades m√©dicas</li>
                    <li>‚Ä¢ Emerg√™ncias</li>
                    <li>‚Ä¢ Falar com m√©dico</li>
                </ul>
                <span class="text-xs text-gray-400">Bot ‚Ä¢ agora</span>
            </div>
        </div>

        <!-- Auto Input Area -->
        <div class="p-4 border-t border-gray-600 bg-gray-800">
            <div class="flex items-center space-x-2">
                <input type="text" id="autoMessageInput" placeholder="Digite sua pergunta m√©dica..." class="flex-1 bg-gray-900 p-3 rounded-full text-sm focus:outline-none focus:ring-2 focus:ring-green-500 border border-gray-600">
                <button onclick="sendAutoMessage()" class="bg-green-600 w-12 h-12 rounded-full hover:bg-green-700 transition flex-shrink-0 flex items-center justify-center">
                    üì§
                </button>
            </div>
        </div>
    </div>

    <!-- Consultation Rooms Container (Center) -->
    <div id="consultationContainer" class="consultation-container bg-gray-900 rounded-2xl shadow-2xl border border-gray-600">
        <!-- Consultation Header -->
        <div class="bg-gradient-to-r from-purple-500 to-indigo-600 p-4 rounded-t-2xl flex justify-between items-center">
            <div class="flex items-center space-x-3">
                <div class="w-10 h-10 bg-white rounded-full flex items-center justify-center">
                    üè•
                </div>
                <div>
                    <h5 class="font-semibold">Salas de Consulta</h5>
                    <p class="text-sm opacity-80">Especialistas online</p>
                </div>
            </div>
            <button onclick="toggleConsultation()" class="text-white hover:bg-white hover:bg-opacity-20 p-2 rounded-full transition">
                ‚úï
            </button>
        </div>

        <!-- Room Selection -->
        <div id="roomSelection" class="p-4">
            <h6 class="font-semibold mb-4">Escolha uma sala de consulta:</h6>
            <div class="space-y-3">
                <button onclick="enterRoom('geral')" class="w-full bg-green-600 hover:bg-green-700 p-4 rounded-xl text-left transition">
                    <div class="flex items-center space-x-3">
                        <span class="text-2xl">ü©∫</span>
                        <div>
                            <h7 class="font-semibold">Sala 1 - Cl√≠nica Geral</h7>
                            <p class="text-sm opacity-80">Dr. Cl√≠nico Geral - Online</p>
                        </div>
                    </div>
                </button>
                
                <button onclick="enterRoom('cardio')" class="w-full bg-red-600 hover:bg-red-700 p-4 rounded-xl text-left transition">
                    <div class="flex items-center space-x-3">
                        <span class="text-2xl">‚ù§Ô∏è</span>
                        <div>
                            <h7 class="font-semibold">Sala 2 - Cardiologia</h7>
                            <p class="text-sm opacity-80">Dr. Cardiologista - Online</p>
                        </div>
                    </div>
                </button>
                
                <button onclick="enterRoom('derma')" class="w-full bg-blue-600 hover:bg-blue-700 p-4 rounded-xl text-left transition">
                    <div class="flex items-center space-x-3">
                        <span class="text-2xl">üß¥</span>
                        <div>
                            <h7 class="font-semibold">Sala 3 - Dermatologia</h7>
                            <p class="text-sm opacity-80">Dr. Dermatologista - Online</p>
                        </div>
                    </div>
                </button>
            </div>
        </div>

        <!-- Room Chat (Hidden initially) -->
        <div id="roomChat" class="hidden flex flex-col h-full">
            <div id="roomHeader" class="p-4 bg-gray-800 border-b border-gray-600 flex-shrink-0">
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-3">
                        <span id="roomIcon" class="text-2xl">ü©∫</span>
                        <div>
                            <h6 id="roomTitle" class="font-semibold">Sala de Consulta</h6>
                            <p id="roomDoctor" class="text-sm opacity-80">M√©dico Online</p>
                        </div>
                    </div>
                    <button onclick="leaveRoom()" class="bg-gray-600 hover:bg-gray-700 px-3 py-1 rounded-lg text-sm transition">
                        Sair
                    </button>
                </div>
            </div>
            
            <div id="roomMessages" class="flex-1 p-4 overflow-y-auto space-y-3 min-h-0">
            </div>
            
            <div class="p-4 border-t border-gray-600 bg-gray-800 flex-shrink-0">
                <div class="flex items-center space-x-2">
                    <input type="text" id="roomMessageInput" placeholder="Digite sua mensagem para o m√©dico..." class="flex-1 bg-gray-900 p-3 rounded-full text-sm focus:outline-none focus:ring-2 focus:ring-purple-500 border border-gray-600">
                    <button onclick="sendRoomMessage()" class="bg-purple-600 w-12 h-12 rounded-full hover:bg-purple-700 transition flex-shrink-0 flex items-center justify-center">
                        üì§
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Nutrition Chat Container -->
    <div id="nutritionChatContainer" class="chat-container bg-gray-900 rounded-2xl shadow-2xl border border-gray-600">
        <!-- Nutrition Chat Header -->
        <div class="bg-gradient-to-r from-green-500 to-lime-600 p-4 rounded-t-2xl flex justify-between items-center">
            <div class="flex items-center space-x-3">
                <div class="w-10 h-10 bg-white rounded-full flex items-center justify-center">
                    ü•ó
                </div>
                <div>
                    <h5 class="font-semibold">Dra. Ana - Nutricionista</h5>
                    <p class="text-sm opacity-80">IA Gemini ‚Ä¢ Especialista em Nutri√ß√£o</p>
                </div>
            </div>
            <button onclick="closeNutritionChat()" class="text-white hover:bg-white hover:bg-opacity-20 p-2 rounded-full transition">
                ‚úï
            </button>
        </div>

        <!-- Status Panel -->
        <div class="p-3 bg-green-900 bg-opacity-80 border-b border-gray-600">
            <p class="text-sm text-green-200 flex items-center">
                <span class="w-2 h-2 bg-green-400 rounded-full mr-2 animate-pulse"></span>
                Nutricionista IA online - Powered by Gemini
            </p>
        </div>

        <!-- Messages Area -->
        <div id="nutritionMessagesArea" class="flex-1 p-4 overflow-y-auto h-64 space-y-3">
            <div class="message-bubble bg-gray-700 p-3 rounded-xl max-w-xs">
                <p class="text-sm">ü•ó Ol√°! Sou o Dr. Nutricionista. Posso ajudar com:</p>
                <ul class="text-xs mt-2 space-y-1">
                    <li>‚Ä¢ Planos alimentares personalizados</li>
                    <li>‚Ä¢ Receitas saud√°veis</li>
                    <li>‚Ä¢ Orienta√ß√µes nutricionais</li>
                    <li>‚Ä¢ Dietas espec√≠ficas</li>
                    <li>‚Ä¢ Suplementa√ß√£o</li>
                </ul>
                <span class="text-xs text-gray-400">Dr. Nutricionista ‚Ä¢ agora</span>
            </div>
        </div>

        <!-- Input Area -->
        <div class="p-4 border-t border-gray-600 bg-gray-800">
            <div class="flex items-center space-x-2">
                <input type="text" id="nutritionMessageInput" placeholder="Pergunte sobre nutri√ß√£o, dietas, receitas..." class="flex-1 bg-gray-900 p-3 rounded-full text-sm focus:outline-none focus:ring-2 focus:ring-green-500 border border-gray-600">
                <button onclick="sendNutritionChatMessage()" class="bg-green-600 w-12 h-12 rounded-full hover:bg-green-700 transition flex-shrink-0 flex items-center justify-center">
                    üì§
                </button>
            </div>
        </div>
    </div>

    <!-- Psychology Chat Container -->
    <div id="psychologyChatContainer" class="auto-chat-container bg-gray-900 rounded-2xl shadow-2xl border border-gray-600">
        <!-- Psychology Chat Header -->
        <div class="bg-gradient-to-r from-purple-500 to-pink-600 p-4 rounded-t-2xl flex justify-between items-center">
            <div class="flex items-center space-x-3">
                <div class="w-10 h-10 bg-white rounded-full flex items-center justify-center">
                    üß†
                </div>
                <div>
                    <h5 class="font-semibold">Dr. Carlos - Psic√≥logo</h5>
                    <p class="text-sm opacity-80">IA Gemini ‚Ä¢ Especialista em V√≠cios</p>
                </div>
            </div>
            <button onclick="closePsychologyChat()" class="text-white hover:bg-white hover:bg-opacity-20 p-2 rounded-full transition">
                ‚úï
            </button>
        </div>

        <!-- Status Panel -->
        <div class="p-3 bg-purple-900 bg-opacity-80 border-b border-gray-600">
            <p class="text-sm text-purple-200 flex items-center">
                <span class="w-2 h-2 bg-purple-400 rounded-full mr-2 animate-pulse"></span>
                Dr. Psic√≥logo online
            </p>
        </div>

        <!-- Messages Area -->
        <div id="psychologyMessagesArea" class="flex-1 p-4 overflow-y-auto h-64 space-y-3">
            <div class="message-bubble bg-gray-700 p-3 rounded-xl max-w-xs">
                <p class="text-sm">üß† Ol√°! Sou o Dr. Psic√≥logo, especialista em v√≠cios. Posso ajudar com:</p>
                <ul class="text-xs mt-2 space-y-1">
                    <li>‚Ä¢ Tratamento de depend√™ncias</li>
                    <li>‚Ä¢ Ansiedade e depress√£o</li>
                    <li>‚Ä¢ Terapia comportamental</li>
                    <li>‚Ä¢ Apoio emocional</li>
                    <li>‚Ä¢ Estrat√©gias de enfrentamento</li>
                </ul>
                <span class="text-xs text-gray-400">Dr. Psic√≥logo ‚Ä¢ agora</span>
            </div>
        </div>

        <!-- Input Area -->
        <div class="p-4 border-t border-gray-600 bg-gray-800">
            <div class="flex items-center space-x-2">
                <input type="text" id="psychologyMessageInput" placeholder="Compartilhe seus sentimentos e preocupa√ß√µes..." class="flex-1 bg-gray-900 p-3 rounded-full text-sm focus:outline-none focus:ring-2 focus:ring-purple-500 border border-gray-600">
                <button onclick="sendPsychologyChatMessage()" class="bg-purple-600 w-12 h-12 rounded-full hover:bg-purple-700 transition flex-shrink-0 flex items-center justify-center">
                    üì§
                </button>
            </div>
        </div>
    </div>

    <!-- Pharmacy Finder Container -->
    <div id="pharmacyContainer" class="pharmacy-container bg-gray-900 rounded-2xl shadow-2xl border border-gray-600">
        <!-- Pharmacy Header -->
        <div class="bg-gradient-to-r from-orange-500 to-red-600 p-4 rounded-t-2xl flex justify-between items-center">
            <div class="flex items-center space-x-3">
                <div class="w-10 h-10 bg-white rounded-full flex items-center justify-center">
                    üíä
                </div>
                <div>
                    <h5 class="font-semibold">Farm√°cias Pr√≥ximas</h5>
                    <p class="text-sm opacity-80">Encontre medicamentos</p>
                </div>
            </div>
            <button onclick="togglePharmacyFinder()" class="text-white hover:bg-white hover:bg-opacity-20 p-2 rounded-full transition">
                ‚úï
            </button>
        </div>

        <!-- Location Input Section -->
        <div class="p-4 border-b border-gray-600 bg-gray-800">
            <div class="space-y-3">
                <div class="flex space-x-2">
                    <input type="text" id="locationInput" placeholder="Ex: Centro, Universit√°rio, Kennedy, 55000-000..." class="flex-1 bg-gray-900 p-3 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 border border-gray-600">
                    <button onclick="searchByAddress()" class="bg-blue-600 hover:bg-blue-700 px-4 py-3 rounded-xl transition" title="Buscar em Caruaru">
                        üîç
                    </button>
                </div>
                <div class="flex space-x-2">
                    <button onclick="useCurrentLocation()" class="flex-1 bg-gradient-to-r from-green-500 to-teal-600 py-3 rounded-xl font-semibold hover:from-green-600 hover:to-teal-700 transition text-sm">
                        üìç Minha Localiza√ß√£o
                    </button>
                    <button onclick="clickOnMap()" class="flex-1 bg-gradient-to-r from-purple-500 to-indigo-600 py-3 rounded-xl font-semibold hover:from-purple-600 hover:to-indigo-700 transition text-sm">
                        üó∫Ô∏è Clicar no Mapa
                    </button>
                </div>
                <input type="text" id="medicineSearch" placeholder="Buscar medicamento..." class="w-full bg-gray-900 p-3 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-orange-500 border border-gray-600">
            </div>
        </div>

        <!-- Map Container -->
        <div id="mapContainer" class="h-32 bg-gray-800 border-b border-gray-600 relative">
            <div id="map" class="w-full h-full rounded-lg cursor-pointer"></div>
            <div id="mapPlaceholder" class="w-full h-full flex items-center justify-center text-gray-400">
                <div class="text-center">
                    <div class="text-4xl mb-2">üó∫Ô∏è</div>
                    <p class="text-sm">Digite um bairro de Caruaru ou use GPS</p>
                    <p class="text-xs text-gray-500 mt-1">Centro ‚Ä¢ Universit√°rio ‚Ä¢ Kennedy ‚Ä¢ Maur√≠cio de Nassau</p>
                </div>
            </div>
        </div>

        <!-- Results Area -->
        <div id="pharmacyResults" class="flex-1 p-3 overflow-y-auto" style="height: 180px;">
            <div class="text-center text-gray-400">
                <div class="text-3xl mb-2">üíä</div>
                <p class="text-sm">Digite um bairro de Caruaru-PE</p>
                <p class="text-xs text-gray-500 mt-2">Centro, Universit√°rio, Kennedy, Maur√≠cio de Nassau...</p>
            </div>
        </div>
    </div>

    <!-- Live Chat Container (Right) -->
    <div id="chatContainer" class="chat-container bg-gray-900 rounded-2xl shadow-2xl border border-gray-600">
        <!-- Chat Header -->
        <div class="bg-gradient-to-r from-blue-500 to-purple-600 p-4 rounded-t-2xl flex justify-between items-center">
            <div class="flex items-center space-x-3">
                <div class="w-10 h-10 bg-white rounded-full flex items-center justify-center">
                    üí¨
                </div>
                <div>
                    <h5 class="font-semibold">Chat Ao Vivo</h5>
                    <p class="text-sm opacity-80" id="onlineUsers">2 usu√°rios online</p>
                </div>
            </div>
            <button onclick="toggleChat()" class="text-white hover:bg-white hover:bg-opacity-20 p-2 rounded-full transition">
                ‚úï
            </button>
        </div>

        <!-- Status Panel -->
        <div id="statusPanel" class="p-3 bg-green-900 bg-opacity-80 border-b border-gray-600">
            <p class="text-sm text-green-200 flex items-center">
                <span class="w-2 h-2 bg-green-400 rounded-full mr-2 animate-pulse"></span>
                Chat conectado e funcionando
            </p>
        </div>

        <!-- Messages Area -->
        <div id="messagesArea" class="flex-1 p-4 overflow-y-auto h-64 space-y-3">
        </div>

        <!-- Input Area -->
        <div class="p-4 border-t border-gray-600 bg-gray-800">
            <div class="flex items-center space-x-2">
                <!-- Bot√£o de Imagem -->
                <input type="file" id="imageInput" accept="image/*" onchange="sendImage()" class="hidden">
                <button onclick="document.getElementById('imageInput').click()" class="bg-green-600 w-10 h-10 rounded-full hover:bg-green-700 transition flex-shrink-0 flex items-center justify-center" title="Enviar foto">
                    üì∑
                </button>
                
                <!-- Campo de Mensagem -->
                <input type="text" id="messageInput" placeholder="Digite sua mensagem..." class="flex-1 bg-gray-900 p-3 rounded-full text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 border border-gray-600">
                
                <!-- Bot√£o Principal (√Åudio/Envio) -->
                <button id="mainActionBtn" onclick="handleMainAction()" class="bg-blue-600 w-12 h-12 rounded-full hover:bg-blue-700 transition flex-shrink-0 flex items-center justify-center">
                    <span id="mainActionIcon">üì§</span>
                </button>
            </div>
            
            <!-- Status do Microfone -->
            <div id="micStatus" class="mt-2 text-xs text-gray-400 text-center hidden">
                <span class="flex items-center justify-center">
                    <span class="w-2 h-2 bg-red-500 rounded-full mr-2 animate-pulse"></span>
                    Gravando √°udio... Toque para parar
                </span>
            </div>
        </div>
    </div>

    <!-- Audio Elements for Notifications -->
    <audio id="sendSound" preload="auto">
        <source src="data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBSuBzvLZiTYIG2m98OScTgwOUarm7blmGgU7k9n1unEiBC13yO/eizEIHWq+8+OWT" type="audio/wav">
    </audio>
    <audio id="receiveSound" preload="auto">
        <source src="data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBSuBzvLZiTYIG2m98OScTgwOUarm7blmGgU7k9n1unEiBC13yO/eizEIHWq+8+OWT" type="audio/wav">
    </audio>

    <script>
        // API Configuration - Usando Edge Functions do Netlify
        const GEMINI_API_ENDPOINT = '/.netlify/functions/gemini-api';
        const YOUTUBE_API_ENDPOINT = '/.netlify/functions/youtube-search';
        
        // Verifica√ß√£o se as APIs est√£o dispon√≠veis
        const isGeminiConfigured = () => true; // Sempre dispon√≠vel via Edge Function
        const isYouTubeConfigured = () => true; // Sempre dispon√≠vel via Edge Function
        
        // Debug mode para desenvolvimento
        const DEBUG_MODE = true;
        
        // Firebase Configuration - CONFIGURE SEU FIREBASE AQUI
        const firebaseConfig = {
            apiKey: "SUA_API_KEY_AQUI",
            authDomain: "seu-projeto.firebaseapp.com",
            databaseURL: "https://seu-projeto-default-rtdb.firebaseio.com/",
            projectId: "seu-projeto",
            storageBucket: "seu-projeto.appspot.com",
            messagingSenderId: "123456789",
            appId: "1:123456789:web:abcdef123456"
        };

        let database = null;
        let messagesRef = null;
        let isRecording = false;
        let mediaRecorder = null;
        let audioChunks = [];
        let chatOpen = false;
        let autoChatOpen = false;
        let consultationOpen = false;
        let firebaseConnected = false;
        let currentRoom = null;
        let pharmacyOpen = false;
        let userLocation = null;
        let map = null;
        let pharmacyMarkers = [];

        // Demo WebSocket for real-time communication
        let ws = null;
        let userId = 'user_' + Math.random().toString(36).substr(2, 9);

        // Enhanced Notification System with Push Notifications
        function showNotification(title, message, type = 'info', playSound = true) {
            // In-app notification
            const container = document.getElementById('notificationContainer');
            const notification = document.createElement('div');
            
            const colors = {
                success: 'from-green-500 to-emerald-600',
                error: 'from-red-500 to-pink-600',
                warning: 'from-yellow-500 to-orange-600',
                info: 'from-blue-500 to-purple-600',
                message: 'from-purple-500 to-indigo-600'
            };
            
            const icons = {
                success: '‚úÖ',
                error: '‚ùå', 
                warning: '‚ö†Ô∏è',
                info: '‚ÑπÔ∏è',
                message: 'üí¨'
            };
            
            notification.className = `notification bg-gradient-to-r ${colors[type]} p-4 rounded-xl shadow-2xl max-w-sm border border-white border-opacity-20`;
            notification.innerHTML = `
                <div class="flex items-start space-x-3">
                    <span class="text-2xl animate-bounce">${icons[type]}</span>
                    <div class="flex-1">
                        <h6 class="font-bold text-white">${title}</h6>
                        <p class="text-sm text-white opacity-90">${message}</p>
                    </div>
                    <button onclick="this.parentElement.parentElement.remove()" class="text-white hover:bg-white hover:bg-opacity-20 p-1 rounded-full transition">‚úï</button>
                </div>
            `;
            
            container.appendChild(notification);
            
            // Show notification with animation
            setTimeout(() => notification.classList.add('show'), 100);
            
            // Play notification sound
            if (playSound) {
                playNotificationSound(type);
            }
            
            // Auto remove after 6 seconds
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => notification.remove(), 300);
            }, 6000);
            
            // Browser push notification
            showBrowserNotification(title, message, type);
        }
        
        // Browser Push Notifications
        function showBrowserNotification(title, message, type) {
            if (!('Notification' in window)) {
                console.log('Este navegador n√£o suporta notifica√ß√µes push');
                return;
            }
            
            if (Notification.permission === 'granted') {
                const options = {
                    body: message,
                    icon: getNotificationIcon(type),
                    badge: 'üè•',
                    tag: 'clinica-digital',
                    requireInteraction: type === 'error' || type === 'warning',
                    silent: false,
                    vibrate: [200, 100, 200],
                    actions: [
                        {
                            action: 'view',
                            title: 'Ver',
                            icon: 'üëÅÔ∏è'
                        },
                        {
                            action: 'close',
                            title: 'Fechar',
                            icon: '‚úï'
                        }
                    ]
                };
                
                const notification = new Notification(title, options);
                
                notification.onclick = function() {
                    window.focus();
                    notification.close();
                };
                
                // Auto close after 8 seconds
                setTimeout(() => {
                    notification.close();
                }, 8000);
                
            } else if (Notification.permission !== 'denied') {
                Notification.requestPermission().then(permission => {
                    if (permission === 'granted') {
                        showBrowserNotification(title, message, type);
                    }
                });
            }
        }
        
        function getNotificationIcon(type) {
            const icons = {
                success: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="50" r="40" fill="%2310b981"/><path d="M30 50l10 10 20-20" stroke="white" stroke-width="4" fill="none"/></svg>',
                error: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="50" r="40" fill="%23ef4444"/><path d="M35 35l30 30M65 35l-30 30" stroke="white" stroke-width="4"/></svg>',
                warning: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="50" r="40" fill="%23f59e0b"/><path d="M50 25v30M50 65v5" stroke="white" stroke-width="4"/></svg>',
                info: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="50" r="40" fill="%233b82f6"/><path d="M50 35v30M50 25v5" stroke="white" stroke-width="4"/></svg>',
                message: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="50" r="40" fill="%238b5cf6"/><path d="M25 40h50v20H35l-10 10V40z" fill="white"/></svg>'
            };
            return icons[type] || icons.info;
        }
        
        // Enhanced Sound System
        function playNotificationSound(type) {
            const sounds = {
                success: createNotificationTone(800, 0.1, 'sine'),
                error: createNotificationTone(300, 0.2, 'square'),
                warning: createNotificationTone(600, 0.15, 'triangle'),
                info: createNotificationTone(500, 0.1, 'sine'),
                message: createNotificationTone(700, 0.1, 'sine'),
                send: createNotificationTone(900, 0.08, 'sine'),
                receive: createNotificationTone(600, 0.12, 'sine')
            };
            
            if (sounds[type]) {
                sounds[type]();
            }
        }
        
        function createNotificationTone(frequency, duration, waveType = 'sine') {
            return function() {
                try {
                    const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);
                    
                    oscillator.frequency.value = frequency;
                    oscillator.type = waveType;
                    
                    gainNode.gain.setValueAtTime(0, audioContext.currentTime);
                    gainNode.gain.linearRampToValueAtTime(0.1, audioContext.currentTime + 0.01);
                    gainNode.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + duration);
                    
                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + duration);
                } catch (error) {
                    console.log('√Åudio n√£o dispon√≠vel:', error);
                }
            };
        }

        // Sistema de fallback para desenvolvimento local
        const USE_FALLBACK = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1' || !window.location.hostname.includes('netlify');
        
        // Verifica√ß√£o de API Keys
        function checkApiKeys() {
            if (USE_FALLBACK) {
                console.log('üîß Modo desenvolvimento - usando respostas simuladas');
                showNotification('Modo Demo!', 'Usando respostas simuladas para desenvolvimento', 'info');
                return;
            }
            
            console.log('üîç Verificando conex√£o com Edge Functions...');
            
            // Testar conex√£o com Gemini API
            fetch(GEMINI_API_ENDPOINT, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ test: true })
            }).then(response => {
                if (response.ok) {
                    console.log('‚úÖ Gemini API Edge Function dispon√≠vel');
                    showNotification('APIs Online!', 'Gemini API conectada com sucesso', 'success');
                } else {
                    console.warn('‚ö†Ô∏è Gemini API Edge Function indispon√≠vel');
                    showNotification('API Offline!', 'Usando modo fallback', 'warning');
                }
            }).catch(error => {
                console.warn('‚ö†Ô∏è Erro ao conectar com Gemini Edge Function:', error);
                showNotification('Erro de Conex√£o!', 'Usando respostas simuladas', 'warning');
            });
            
            // Testar conex√£o com YouTube API
            fetch(YOUTUBE_API_ENDPOINT + '?test=true')
            .then(response => {
                if (response.ok) {
                    console.log('‚úÖ YouTube API Edge Function dispon√≠vel');
                } else {
                    console.warn('‚ö†Ô∏è YouTube API Edge Function indispon√≠vel');
                }
            }).catch(error => {
                console.warn('‚ö†Ô∏è Erro ao conectar com YouTube Edge Function:', error);
            });
        }

        // Gemini AI Integration - FUN√á√ÉO PRINCIPAL PARA AN√ÅLISE DE SINTOMAS
        async function analyzeSymptoms() {
            const symptomsInput = document.getElementById('symptomsInput');
            const analyzeBtn = document.getElementById('analyzeBtn');
            const diagnosisResult = document.getElementById('diagnosisResult');
            const diagnosisText = document.getElementById('diagnosisText');
            const videoSection = document.getElementById('videoSection');
            
            const symptoms = symptomsInput.value.trim();
            
            if (!symptoms) {
                showNotification('Aten√ß√£o!', 'Por favor, descreva seus sintomas', 'warning');
                return;
            }
            
            analyzeBtn.disabled = true;
            analyzeBtn.innerHTML = 'üîÑ Analisando...';
            
            console.log('üöÄ Iniciando an√°lise m√©dica...');
            
            try {
                let diagnosis;
                
                // Verificar se deve usar fallback
                if (USE_FALLBACK) {
                    console.log('üîß Usando resposta simulada para an√°lise de sintomas');
                    diagnosis = getSymptomsFallbackResponse(symptoms);
                } else {
                    const requestBody = {
                        symptoms: symptoms,
                        type: 'symptom_analysis',
                        prompt: `Voc√™ √© um assistente m√©dico virtual. Analise os sintomas descritos e forne√ßa uma resposta em portugu√™s brasileiro com no m√°ximo 200 palavras.

Inclua:
1. Poss√≠veis causas
2. Cuidados b√°sicos recomendados  
3. Quando procurar ajuda m√©dica
4. Disclaimer: "Esta √© apenas uma an√°lise preliminar e n√£o substitui consulta m√©dica profissional"

Sintomas relatados: ${symptoms}`,
                        generationConfig: {
                            maxOutputTokens: 300,
                            temperature: 0.3,
                            topP: 0.8,
                            topK: 40
                        }
                    };
                    
                    console.log('üì§ Enviando requisi√ß√£o para Edge Function...');
                    
                    const response = await fetch(GEMINI_API_ENDPOINT, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(requestBody)
                    });
                    
                    console.log('üì• Resposta recebida:', response.status);
                    
                    if (!response.ok) {
                        const errorData = await response.json().catch(() => ({ error: 'Erro desconhecido' }));
                        console.error('‚ùå Erro da Edge Function:', errorData);
                        throw new Error(`Erro da API: ${response.status} - ${errorData.error || 'Erro desconhecido'}`);
                    }
                    
                    const data = await response.json();
                    console.log('‚úÖ Dados recebidos:', data);
                    
                    if (data.response) {
                        diagnosis = data.response;
                    } else {
                        console.error('‚ùå Estrutura de resposta inv√°lida:', data);
                        throw new Error('Resposta da Edge Function em formato inv√°lido');
                    }
                }
                
                // Exibir o diagn√≥stico
                diagnosisText.innerHTML = diagnosis.replace(/\n/g, '<br>');
                diagnosisResult.classList.remove('hidden');
                
                // SEMPRE buscar e exibir v√≠deos educativos relacionados
                console.log('üé• Buscando v√≠deos educativos...');
                const educationalVideos = generateEducationalVideos(symptoms);
                displayHealthVideos(educationalVideos);
                
                // GARANTIR que a se√ß√£o de v√≠deos seja vis√≠vel
                const videoSection = document.getElementById('videoSection');
                if (videoSection) {
                    videoSection.classList.remove('hidden');
                    videoSection.style.display = 'block';
                }
                
                showNotification('An√°lise conclu√≠da!', 'Relat√≥rio m√©dico gerado com v√≠deos educativos', 'success');
                console.log('‚úÖ An√°lise conclu√≠da com sucesso');
                
            } catch (error) {
                console.error('‚ùå Erro completo:', error);
                
                // Usar fallback em caso de erro
                console.log('üîÑ Usando resposta de fallback devido ao erro');
                const fallbackDiagnosis = getSymptomsFallbackResponse(symptoms);
                diagnosisText.innerHTML = fallbackDiagnosis.replace(/\n/g, '<br>');
                diagnosisResult.classList.remove('hidden');
                
                // SEMPRE buscar v√≠deos educativos mesmo em caso de erro
                console.log('üé• Buscando v√≠deos educativos (fallback)...');
                const educationalVideos = generateEducationalVideos(symptoms);
                displayHealthVideos(educationalVideos);
                
                // GARANTIR que a se√ß√£o de v√≠deos seja vis√≠vel mesmo no fallback
                const videoSection = document.getElementById('videoSection');
                if (videoSection) {
                    videoSection.classList.remove('hidden');
                    videoSection.style.display = 'block';
                }
                
                showNotification('An√°lise (Demo)!', 'Usando resposta simulada devido a erro de conex√£o', 'warning');
            } finally {
                analyzeBtn.disabled = false;
                analyzeBtn.innerHTML = 'üîç Analisar Sintomas';
            }
        }
        
        // Fun√ß√£o de fallback para an√°lise de sintomas
        function getSymptomsFallbackResponse(symptoms) {
            const symptomsLower = symptoms.toLowerCase();
            
            if (symptomsLower.includes('dor de cabe√ßa') || symptomsLower.includes('cefaleia')) {
                return `**An√°lise Preliminar - Dor de Cabe√ßa**

**Poss√≠veis causas:**
- Tens√£o muscular
- Desidrata√ß√£o
- Estresse
- Falta de sono
- Problemas de vis√£o

**Cuidados recomendados:**
- Hidrate-se adequadamente
- Descanse em ambiente escuro
- Aplique compressas frias na testa
- Evite ru√≠dos altos

**Procure ajuda m√©dica se:**
- Dor muito intensa ou s√∫bita
- Acompanhada de febre alta
- Persistir por mais de 3 dias
- Houver altera√ß√µes na vis√£o

*Esta √© apenas uma an√°lise preliminar e n√£o substitui consulta m√©dica profissional.*`;
            }
            
            if (symptomsLower.includes('febre') || symptomsLower.includes('temperatura')) {
                return `**An√°lise Preliminar - Febre**

**Poss√≠veis causas:**
- Infec√ß√£o viral ou bacteriana
- Rea√ß√£o inflamat√≥ria
- Desidrata√ß√£o
- Rea√ß√£o a medicamentos

**Cuidados recomendados:**
- Mantenha-se hidratado
- Descanse adequadamente
- Use roupas leves
- Monitore a temperatura

**Procure ajuda m√©dica se:**
- Febre acima de 39¬∞C
- Persistir por mais de 3 dias
- Acompanhada de dificuldade respirat√≥ria
- Houver sinais de desidrata√ß√£o

*Esta √© apenas uma an√°lise preliminar e n√£o substitui consulta m√©dica profissional.*`;
            }
            
            if (symptomsLower.includes('tosse') || symptomsLower.includes('garganta')) {
                return `**An√°lise Preliminar - Sintomas Respirat√≥rios**

**Poss√≠veis causas:**
- Infec√ß√£o viral (resfriado)
- Irrita√ß√£o das vias a√©reas
- Alergia respirat√≥ria
- Refluxo gastroesof√°gico

**Cuidados recomendados:**
- Mantenha-se hidratado
- Use umidificador de ar
- Evite irritantes (fuma√ßa, poeira)
- Fa√ßa gargarejos com √°gua morna e sal

**Procure ajuda m√©dica se:**
- Dificuldade para respirar
- Tosse com sangue
- Febre alta persistente
- Piora dos sintomas

*Esta √© apenas uma an√°lise preliminar e n√£o substitui consulta m√©dica profissional.*`;
            }
            
            // Resposta gen√©rica
            return `**An√°lise Preliminar dos Sintomas**

Com base nos sintomas relatados: "${symptoms}"

**Recomenda√ß√µes gerais:**
- Monitore a evolu√ß√£o dos sintomas
- Mantenha-se hidratado
- Descanse adequadamente
- Evite automedica√ß√£o

**Cuidados importantes:**
- Anote quando os sintomas come√ßaram
- Observe se h√° piora ou melhora
- Mantenha alimenta√ß√£o leve
- Evite atividades f√≠sicas intensas

**Procure ajuda m√©dica se:**
- Os sintomas piorarem
- Surgirem novos sintomas
- Houver dor intensa
- Persistir por mais de alguns dias

*Esta √© apenas uma an√°lise preliminar e n√£o substitui consulta m√©dica profissional. Recomendamos consultar um m√©dico para avalia√ß√£o adequada.*`;
        }

        // Gerar v√≠deos educativos espec√≠ficos por sintoma
        function generateEducationalVideos(query) {
            const queryLower = query.toLowerCase();
            
            // V√≠deos espec√≠ficos por sintoma
            if (queryLower.includes('dor de cabe√ßa') || queryLower.includes('cefaleia') || queryLower.includes('enxaqueca')) {
                return [
                    {
                        title: "Como Aliviar Dor de Cabe√ßa Naturalmente - T√©cnicas Eficazes",
                        channelTitle: "Sa√∫de e Bem-Estar",
                        searchQuery: "como aliviar dor de cabe√ßa naturalmente t√©cnicas",
                        thumbnail: "https://via.placeholder.com/120x90/4ade80/ffffff?text=üíä"
                    },
                    {
                        title: "Exerc√≠cios para Dor de Cabe√ßa Tensional - Al√≠vio Imediato",
                        channelTitle: "Fisioterapia Online",
                        searchQuery: "exerc√≠cios dor de cabe√ßa tensional al√≠vio",
                        thumbnail: "https://via.placeholder.com/120x90/06b6d4/ffffff?text=üßò"
                    },
                    {
                        title: "Dor de Cabe√ßa: Quando Procurar o M√©dico - Sinais de Alerta",
                        channelTitle: "Dr. Medicina",
                        searchQuery: "dor de cabe√ßa quando procurar m√©dico sinais alerta",
                        thumbnail: "https://via.placeholder.com/120x90/ef4444/ffffff?text=üö®"
                    }
                ];
            }
            
            if (queryLower.includes('febre') || queryLower.includes('temperatura')) {
                return [
                    {
                        title: "Como Baixar a Febre em Casa - M√©todos Seguros e Eficazes",
                        channelTitle: "Sa√∫de Familiar",
                        searchQuery: "como baixar febre em casa m√©todos seguros",
                        thumbnail: "https://via.placeholder.com/120x90/f59e0b/ffffff?text=üå°Ô∏è"
                    },
                    {
                        title: "Febre: Quando Procurar o M√©dico - Guia Completo",
                        channelTitle: "Dr. Pediatria",
                        searchQuery: "febre quando procurar m√©dico guia completo",
                        thumbnail: "https://via.placeholder.com/120x90/dc2626/ffffff?text=üè•"
                    },
                    {
                        title: "Hidrata√ß√£o Durante a Febre - Import√¢ncia e Dicas",
                        channelTitle: "Nutri√ß√£o e Sa√∫de",
                        searchQuery: "hidrata√ß√£o durante febre import√¢ncia dicas",
                        thumbnail: "https://via.placeholder.com/120x90/3b82f6/ffffff?text=üíß"
                    }
                ];
            }
            
            if (queryLower.includes('tosse') || queryLower.includes('garganta')) {
                return [
                    {
                        title: "Rem√©dios Caseiros para Tosse - Receitas Naturais Eficazes",
                        channelTitle: "Medicina Natural",
                        searchQuery: "rem√©dios caseiros tosse receitas naturais",
                        thumbnail: "https://via.placeholder.com/120x90/10b981/ffffff?text=üåø"
                    },
                    {
                        title: "Diferen√ßas Entre Tipos de Tosse - Seca vs Produtiva",
                        channelTitle: "Dr. Pneumologia",
                        searchQuery: "diferen√ßas tipos tosse seca produtiva",
                        thumbnail: "https://via.placeholder.com/120x90/8b5cf6/ffffff?text=ü´Å"
                    },
                    {
                        title: "Tosse Persistente: Causas e Tratamentos",
                        channelTitle: "Sa√∫de Respirat√≥ria",
                        searchQuery: "tosse persistente causas tratamentos",
                        thumbnail: "https://via.placeholder.com/120x90/f97316/ffffff?text=‚öïÔ∏è"
                    }
                ];
            }
            
            if (queryLower.includes('dor no peito') || queryLower.includes('cora√ß√£o') || queryLower.includes('palpita√ß√£o')) {
                return [
                    {
                        title: "Dor no Peito: Quando √© Emerg√™ncia - Sinais de Infarto",
                        channelTitle: "Dr. Cardiologia",
                        searchQuery: "dor no peito emerg√™ncia sinais infarto",
                        thumbnail: "https://via.placeholder.com/120x90/dc2626/ffffff?text=‚ù§Ô∏è"
                    },
                    {
                        title: "Exerc√≠cios para Fortalecer o Cora√ß√£o - Preven√ß√£o Cardiovascular",
                        channelTitle: "Cardiologia Preventiva",
                        searchQuery: "exerc√≠cios fortalecer cora√ß√£o preven√ß√£o",
                        thumbnail: "https://via.placeholder.com/120x90/059669/ffffff?text=üí™"
                    },
                    {
                        title: "Palpita√ß√µes: Causas Comuns e Quando Se Preocupar",
                        channelTitle: "Sa√∫de do Cora√ß√£o",
                        searchQuery: "palpita√ß√µes causas quando preocupar",
                        thumbnail: "https://via.placeholder.com/120x90/7c3aed/ffffff?text=üíì"
                    }
                ];
            }
            
            if (queryLower.includes('dor nas costas') || queryLower.includes('coluna')) {
                return [
                    {
                        title: "Exerc√≠cios para Dor nas Costas - Al√≠vio e Fortalecimento",
                        channelTitle: "Fisioterapia Especializada",
                        searchQuery: "exerc√≠cios dor nas costas al√≠vio fortalecimento",
                        thumbnail: "https://via.placeholder.com/120x90/06b6d4/ffffff?text=üèÉ"
                    },
                    {
                        title: "Postura Correta no Trabalho - Preven√ß√£o de Dores",
                        channelTitle: "Ergonomia e Sa√∫de",
                        searchQuery: "postura correta trabalho preven√ß√£o dores",
                        thumbnail: "https://via.placeholder.com/120x90/10b981/ffffff?text=ü™ë"
                    },
                    {
                        title: "Dor na Coluna: Tratamentos e Cuidados Essenciais",
                        channelTitle: "Ortopedia Online",
                        searchQuery: "dor coluna tratamentos cuidados essenciais",
                        thumbnail: "https://via.placeholder.com/120x90/f59e0b/ffffff?text=ü¶¥"
                    }
                ];
            }
            
            // V√≠deos gen√©ricos para outros sintomas
            return [
                {
                    title: "Primeiros Socorros em Casa - Guia Essencial de Sa√∫de",
                    channelTitle: "Medicina de Emerg√™ncia",
                    searchQuery: `${query} primeiros socorros sa√∫de medicina`,
                    thumbnail: "https://via.placeholder.com/120x90/ef4444/ffffff?text=üöë"
                },
                {
                    title: "Quando Procurar Ajuda M√©dica - Sinais de Alerta",
                    channelTitle: "Dr. Cl√≠nica Geral",
                    searchQuery: `${query} quando procurar m√©dico sinais alerta`,
                    thumbnail: "https://via.placeholder.com/120x90/3b82f6/ffffff?text=üè•"
                },
                {
                    title: "Cuidados B√°sicos de Sa√∫de - Preven√ß√£o e Bem-Estar",
                    channelTitle: "Sa√∫de Preventiva",
                    searchQuery: `${query} cuidados b√°sicos sa√∫de preven√ß√£o`,
                    thumbnail: "https://via.placeholder.com/120x90/10b981/ffffff?text=üíö"
                }
            ];
        }

        // FUN√á√ÉO PRINCIPAL PARA EXIBIR V√çDEOS - 100% FUNCIONAL GARANTIDO
        function displayHealthVideos(videos) {
            console.log('üé• INICIANDO displayHealthVideos - GARANTINDO FUNCIONAMENTO 100%');
            console.log('üìπ V√≠deos recebidos:', videos.length);
            
            const videoSection = document.getElementById('videoSection');
            
            if (!videoSection) {
                console.error('‚ùå ERRO CR√çTICO: videoSection n√£o encontrado');
                // CRIAR A SE√á√ÉO SE N√ÉO EXISTIR
                const diagnosisResult = document.getElementById('diagnosisResult');
                if (diagnosisResult) {
                    const newVideoSection = document.createElement('div');
                    newVideoSection.id = 'videoSection';
                    newVideoSection.className = 'mt-6';
                    diagnosisResult.parentNode.insertBefore(newVideoSection, diagnosisResult.nextSibling);
                    console.log('‚úÖ videoSection CRIADA dinamicamente');
                } else {
                    console.error('‚ùå FALHA TOTAL: N√£o foi poss√≠vel criar videoSection');
                    return;
                }
            }
            
            // FOR√áAR VISIBILIDADE ABSOLUTA
            videoSection.classList.remove('hidden');
            videoSection.style.display = 'block !important';
            videoSection.style.visibility = 'visible';
            videoSection.style.opacity = '1';
            
            console.log('üé• CONSTRUINDO HTML DOS V√çDEOS...');
            
            let videosHtml = `
                <div class="bg-blue-900 bg-opacity-50 rounded-xl p-6 mt-4" style="display: block !important; visibility: visible !important;">
                    <h5 class="text-xl font-bold mb-4 text-blue-300 flex items-center">
                        <span class="mr-2 text-2xl">üì∫</span>
                        V√çDEOS EDUCATIVOS RELACIONADOS
                    </h5>
                    <p class="text-sm text-blue-200 mb-4">‚úÖ Assista a conte√∫dos educativos sobre seus sintomas:</p>
                    <div class="bg-green-800 bg-opacity-30 p-3 rounded-lg mb-4">
                        <p class="text-green-200 text-sm font-semibold">üéØ ${videos.length} v√≠deos encontrados e carregados com sucesso!</p>
                    </div>
            `;
            
            videos.forEach((video, index) => {
                const title = video.title || `V√≠deo Educativo ${index + 1}`;
                const channelTitle = video.channelTitle || 'Canal M√©dico Educativo';
                const thumbnailUrl = video.thumbnail || `https://via.placeholder.com/120x90/10b981/ffffff?text=üì∫${index + 1}`;
                const searchQuery = video.searchQuery || title;
                
                console.log(`üìπ Processando v√≠deo ${index + 1}: ${title}`);
                
                videosHtml += `
                    <div class="bg-gray-800 rounded-lg p-4 mb-3 border-2 border-blue-500 hover:border-green-400 transition-all duration-300 shadow-lg">
                        <div class="flex items-start space-x-4">
                            <div class="w-24 h-18 bg-gradient-to-br from-blue-600 to-purple-600 rounded-lg overflow-hidden flex-shrink-0 shadow-md">
                                <img src="${thumbnailUrl}" alt="Thumbnail do v√≠deo" class="w-full h-full object-cover" onerror="this.src='https://via.placeholder.com/120x90/10b981/ffffff?text=üì∫${index + 1}';">
                            </div>
                            <div class="flex-1 min-w-0">
                                <h6 class="font-bold text-sm mb-2 text-white leading-tight">${title}</h6>
                                <p class="text-xs text-blue-300 mb-3 font-medium">üè• ${channelTitle}</p>
                                <button onclick="searchVideoOnYouTube('${searchQuery.replace(/'/g, "\\'")}')" class="bg-gradient-to-r from-red-600 to-red-700 hover:from-red-700 hover:to-red-800 px-4 py-2 rounded-lg text-xs font-bold transition-all duration-200 flex items-center space-x-2 shadow-md transform hover:scale-105">
                                    <span class="text-base">üîç</span>
                                    <span>ASSISTIR NO YOUTUBE</span>
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            videosHtml += `
                    <div class="text-center mt-6 p-4 bg-green-900 bg-opacity-40 rounded-lg">
                        <p class="text-sm text-green-300 font-semibold">‚úÖ V√çDEOS CARREGADOS COM SUCESSO!</p>
                        <p class="text-xs text-green-200 mt-1">üí° Conte√∫do educativo baseado nos seus sintomas espec√≠ficos</p>
                    </div>
                </div>
            `;
            
            // INSERIR HTML COM FOR√áA TOTAL
            videoSection.innerHTML = videosHtml;
            
            // GARANTIAS M√öLTIPLAS DE VISIBILIDADE
            setTimeout(() => {
                videoSection.classList.remove('hidden');
                videoSection.style.display = 'block';
                videoSection.style.visibility = 'visible';
                videoSection.style.opacity = '1';
                console.log('üîÑ SEGUNDA VERIFICA√á√ÉO DE VISIBILIDADE APLICADA');
            }, 100);
            
            setTimeout(() => {
                videoSection.classList.remove('hidden');
                videoSection.style.display = 'block';
                console.log('üîÑ TERCEIRA VERIFICA√á√ÉO DE VISIBILIDADE APLICADA');
            }, 500);
            
            console.log('‚úÖ V√çDEOS EDUCATIVOS INSERIDOS COM SUCESSO TOTAL!');
            console.log('üîç Estado final da se√ß√£o:', {
                existe: !!videoSection,
                hidden: videoSection.classList.contains('hidden'),
                display: videoSection.style.display,
                visibility: videoSection.style.visibility,
                opacity: videoSection.style.opacity,
                conteudo: videoSection.innerHTML.length > 0,
                totalVideos: videos.length
            });
            
            // LOG DE CONFIRMA√á√ÉO FINAL
            console.log('üéØ MISS√ÉO CUMPRIDA: V√≠deos educativos 100% funcionais e vis√≠veis!');
        }

        function searchVideoOnYouTube(query) {
            const youtubeUrl = `https://www.youtube.com/results?search_query=${encodeURIComponent(query)}`;
            window.open(youtubeUrl, '_blank');
            showNotification('Redirecionando...', 'Abrindo busca no YouTube', 'info');
        }

        // AI Specialist Response System
        async function getAISpecialistResponse(patientMessage, roomType) {
            // Validar se o roomType √© v√°lido
            if (!roomType || !['geral', 'cardio', 'derma'].includes(roomType)) {
                console.error(`‚ùå Tipo de sala inv√°lido: ${roomType}`);
                throw new Error(`Tipo de sala inv√°lido: ${roomType}`);
            }
            
            const specialistPrompts = {
                'geral': {
                    persona: 'Dr. Cl√≠nico Geral, m√©dico com 15 anos de experi√™ncia',
                    context: 'Voc√™ √© um cl√≠nico geral experiente que atende pacientes com diversas condi√ß√µes de sa√∫de. Seja emp√°tico, profissional e forne√ßa orienta√ß√µes m√©dicas gerais.',
                    expertise: 'medicina geral, diagn√≥stico inicial, preven√ß√£o, cuidados b√°sicos de sa√∫de, sintomas gerais',
                    greeting: 'Ol√°! Sou o Dr. Cl√≠nico Geral.'
                },
                'cardio': {
                    persona: 'Dr. Cardiologista, especialista com 12 anos de experi√™ncia',
                    context: 'Voc√™ √© um cardiologista experiente especializado em sa√∫de cardiovascular. Foque EXCLUSIVAMENTE em quest√µes do cora√ß√£o, press√£o arterial, colesterol e preven√ß√£o cardiovascular.',
                    expertise: 'cardiologia, hipertens√£o, arritmias, insufici√™ncia card√≠aca, preven√ß√£o cardiovascular, colesterol, dor no peito, palpita√ß√µes',
                    greeting: 'Ol√°! Sou o Dr. Cardiologista.'
                },
                'derma': {
                    persona: 'Dr. Dermatologista, especialista com 10 anos de experi√™ncia',
                    context: 'Voc√™ √© um dermatologista experiente especializado EXCLUSIVAMENTE em sa√∫de da pele, cabelo e unhas. Foque apenas em problemas dermatol√≥gicos, cuidados com a pele e tratamentos dermatol√≥gicos.',
                    expertise: 'dermatologia, acne, eczema, psor√≠ase, c√¢ncer de pele, cuidados com a pele, cabelo, unhas, manchas, coceira, les√µes cut√¢neas',
                    greeting: 'Ol√°! Sou o Dr. Dermatologista.'
                }
            };
            
            const specialist = specialistPrompts[roomType];
            
            if (!specialist) {
                console.error(`‚ùå Especialista n√£o encontrado para: ${roomType}`);
                throw new Error(`Especialista n√£o encontrado para: ${roomType}`);
            }
            
            console.log(`ü©∫ Consultando ${specialist.persona} para sala: ${roomType}...`);
            
            // Verificar se deve usar fallback
            if (USE_FALLBACK) {
                console.log('üîß Usando resposta simulada para especialista');
                return getSpecialistFallbackResponse(patientMessage, roomType, specialist);
            }
            
            const prompt = `Voc√™ √© ${specialist.persona}.

IMPORTANTE: Voc√™ DEVE responder APENAS como este especialista espec√≠fico.

CONTEXTO: ${specialist.context}

ESPECIALIDADE EXCLUSIVA: ${specialist.expertise}

INSTRU√á√ïES OBRIGAT√ìRIAS:
- Responda SEMPRE como ${specialist.persona}
- Inicie com: "${specialist.greeting}"
- Use linguagem profissional mas acess√≠vel
- Seja emp√°tico e acolhedor
- Forne√ßa orienta√ß√µes m√©dicas ESPEC√çFICAS da sua especialidade
- Se a pergunta N√ÉO for da sua √°rea, diga: "Esta quest√£o n√£o √© da minha especialidade como [sua especialidade]. Recomendo consultar um [especialista correto]."
- Sempre inclua disclaimer sobre consulta presencial quando necess√°rio
- Limite sua resposta a 150 palavras
- Use portugu√™s brasileiro
- NUNCA responda sobre outras especialidades

PERGUNTA DO PACIENTE: "${patientMessage}"

Responda EXCLUSIVAMENTE como ${specialist.persona}:`;
            
            const requestBody = {
                message: patientMessage,
                roomType: roomType,
                prompt: prompt,
                specialist: specialist,
                generationConfig: {
                    maxOutputTokens: 250,
                    temperature: 0.3,
                    topP: 0.8,
                    topK: 40
                }
            };
            
            try {
                const response = await fetch(GEMINI_API_ENDPOINT, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(requestBody)
                });
                
                if (!response.ok) {
                    const errorData = await response.json().catch(() => ({ error: 'Erro desconhecido' }));
                    console.error('‚ùå Erro da Edge Function Gemini:', errorData);
                    throw new Error(`Erro da API: ${response.status} - ${errorData.error || 'Erro desconhecido'}`);
                }
                
                const data = await response.json();
                
                if (data.response) {
                    const aiResponse = data.response;
                    console.log(`‚úÖ Resposta do ${specialist.persona} recebida para sala ${roomType}`);
                    
                    // Validar se a resposta cont√©m a identifica√ß√£o do especialista
                    if (!aiResponse.includes(specialist.greeting.split(',')[0])) {
                        console.warn(`‚ö†Ô∏è Resposta pode n√£o estar correta para ${specialist.persona}`);
                    }
                    
                    return aiResponse;
                } else {
                    console.error('‚ùå Estrutura de resposta inv√°lida:', data);
                    throw new Error('Resposta da Edge Function em formato inv√°lido');
                }
            } catch (error) {
                console.error('‚ùå Erro na API, usando fallback:', error);
                return getSpecialistFallbackResponse(patientMessage, roomType, specialist);
            }
        }
        
        // Fun√ß√£o de fallback para especialistas
        function getSpecialistFallbackResponse(message, roomType, specialist) {
            const messageLower = message.toLowerCase();
            
            const responses = {
                'geral': {
                    'dor': `${specialist.greeting} Entendo que est√° sentindo dor. Para dores gerais, recomendo: descanso, aplica√ß√£o de gelo ou calor conforme o caso, e hidrata√ß√£o. Se a dor persistir ou for muito intensa, procure atendimento m√©dico presencial para avalia√ß√£o adequada.`,
                    'febre': `${specialist.greeting} Febre pode indicar infec√ß√£o. Mantenha-se hidratado, descanse e monitore a temperatura. Se passar de 38,5¬∞C ou persistir por mais de 2 dias, procure atendimento m√©dico. Esta orienta√ß√£o n√£o substitui consulta presencial.`,
                    'default': `${specialist.greeting} Como cl√≠nico geral, posso ajudar com diversos problemas de sa√∫de. Baseado no que relatou, recomendo monitorar os sintomas e manter cuidados b√°sicos de sa√∫de. Para avalia√ß√£o completa, agende consulta presencial.`
                },
                'cardio': {
                    'cora√ß√£o': `${specialist.greeting} Quest√µes card√≠acas requerem aten√ß√£o especial. Para sa√∫de do cora√ß√£o, recomendo: exerc√≠cios regulares, dieta com pouco sal, controle do estresse. Se h√° dor no peito ou palpita√ß√µes, procure atendimento imediato.`,
                    'press√£o': `${specialist.greeting} Para controle da press√£o arterial: reduza sal, pratique exerc√≠cios, mantenha peso adequado, evite estresse. Monitore regularmente e tome medica√ß√£o conforme prescri√ß√£o m√©dica. Consulta presencial √© essencial.`,
                    'default': `${specialist.greeting} Como cardiologista, foco em sa√∫de cardiovascular. Baseado no que relatou, recomendo cuidados com cora√ß√£o: exerc√≠cios, alimenta√ß√£o saud√°vel, controle de fatores de risco. Agende consulta para avalia√ß√£o completa.`
                },
                'derma': {
                    'pele': `${specialist.greeting} Para cuidados com a pele: use protetor solar diariamente, hidrate bem, evite produtos irritantes. Se h√° les√µes, manchas ou coceira persistente, √© importante avalia√ß√£o presencial para diagn√≥stico correto.`,
                    'acne': `${specialist.greeting} Para acne: mantenha pele limpa, use produtos adequados ao seu tipo de pele, evite espremer les√µes. Tratamentos espec√≠ficos devem ser prescritos ap√≥s avalia√ß√£o dermatol√≥gica presencial.`,
                    'default': `${specialist.greeting} Como dermatologista, cuido da sa√∫de da pele, cabelo e unhas. Baseado no que relatou, recomendo cuidados b√°sicos e prote√ß√£o solar. Para diagn√≥stico preciso, consulta presencial √© fundamental.`
                }
            };
            
            const roomResponses = responses[roomType];
            
            // Buscar resposta espec√≠fica baseada na mensagem
            for (const [keyword, response] of Object.entries(roomResponses)) {
                if (keyword !== 'default' && messageLower.includes(keyword)) {
                    return response;
                }
            }
            
            // Retornar resposta padr√£o
            return roomResponses.default;
        }
        
        // Typing Indicator Functions
        function addTypingIndicator() {
            const messagesArea = document.getElementById('roomMessages');
            const typingDiv = document.createElement('div');
            const typingId = 'typing_' + Date.now();
            
            typingDiv.id = typingId;
            typingDiv.className = 'message-bubble bg-gray-700 p-3 rounded-xl max-w-xs';
            typingDiv.innerHTML = `
                <div class="flex items-center space-x-2">
                    <div class="flex space-x-1">
                        <div class="w-2 h-2 bg-gray-400 rounded-full animate-bounce"></div>
                        <div class="w-2 h-2 bg-gray-400 rounded-full animate-bounce" style="animation-delay: 0.1s"></div>
                        <div class="w-2 h-2 bg-gray-400 rounded-full animate-bounce" style="animation-delay: 0.2s"></div>
                    </div>
                    <span class="text-xs text-gray-400">M√©dico digitando...</span>
                </div>
            `;
            
            messagesArea.appendChild(typingDiv);
            messagesArea.scrollTop = messagesArea.scrollHeight;
            
            return typingId;
        }
        
        function removeTypingIndicator(typingId) {
            const typingElement = document.getElementById(typingId);
            if (typingElement) {
                typingElement.remove();
            }
        }

        // Consultation Rooms
        function toggleConsultation() {
            const consultationContainer = document.getElementById('consultationContainer');
            consultationOpen = !consultationOpen;
            
            if (consultationOpen) {
                consultationContainer.classList.add('open');
                showRoomSelection();
            } else {
                consultationContainer.classList.remove('open');
                leaveRoom();
            }
        }

        function showRoomSelection() {
            document.getElementById('roomSelection').classList.remove('hidden');
            document.getElementById('roomChat').classList.add('hidden');
            currentRoom = null;
        }

        function enterRoom(roomType) {
            currentRoom = roomType;
            console.log(`üö™ Entrando na sala: ${roomType}`);
            
            const roomData = {
                'geral': {
                    icon: 'ü©∫',
                    title: 'Sala 1 - Cl√≠nica Geral',
                    doctor: 'Dr. Cl√≠nico Geral - Online',
                    welcome: 'Ol√°! Sou o Dr. Cl√≠nico Geral. Tenho 15 anos de experi√™ncia em medicina geral. Como posso ajud√°-lo hoje? Pode me contar seus sintomas ou d√∫vidas de sa√∫de.',
                    specialty: 'Cl√≠nica Geral',
                    aiPersona: 'Dr. Cl√≠nico Geral'
                },
                'cardio': {
                    icon: '‚ù§Ô∏è',
                    title: 'Sala 2 - Cardiologia',
                    doctor: 'Dr. Cardiologista - Online',
                    welcome: 'Ol√°! Sou o Dr. Cardiologista. Especializo-me em sa√∫de cardiovascular h√° 12 anos. Vamos cuidar do seu cora√ß√£o! Tem alguma preocupa√ß√£o card√≠aca?',
                    specialty: 'Cardiologia',
                    aiPersona: 'Dr. Cardiologista'
                },
                'derma': {
                    icon: 'üß¥',
                    title: 'Sala 3 - Dermatologia',
                    doctor: 'Dr. Dermatologista - Online',
                    welcome: 'Ol√°! Sou o Dr. Dermatologista. Cuido da sa√∫de da pele, cabelo e unhas h√° 10 anos. Como posso ajudar com sua pele hoje?',
                    specialty: 'Dermatologia',
                    aiPersona: 'Dr. Dermatologista'
                }
            };
            
            const room = roomData[roomType];
            
            if (!room) {
                console.error(`‚ùå Sala n√£o encontrada: ${roomType}`);
                showNotification('Erro!', `Sala ${roomType} n√£o encontrada`, 'error');
                return;
            }
            
            console.log(`‚úÖ Configurando sala: ${room.title} - ${room.aiPersona}`);
            
            document.getElementById('roomIcon').textContent = room.icon;
            document.getElementById('roomTitle').textContent = room.title;
            document.getElementById('roomDoctor').textContent = room.doctor;
            
            document.getElementById('roomSelection').classList.add('hidden');
            document.getElementById('roomChat').classList.remove('hidden');
            
            // Limpar mensagens anteriores
            const messagesArea = document.getElementById('roomMessages');
            messagesArea.innerHTML = '';
            
            // Add welcome message
            addRoomMessage(room.welcome, false, room.aiPersona);
            
            showNotification('Consulta iniciada!', `Voc√™ entrou na ${room.title}`, 'success');
            console.log(`üè• Sala ${roomType} configurada com sucesso - Especialista: ${room.aiPersona}`);
        }

        function leaveRoom() {
            if (currentRoom) {
                showNotification('Consulta finalizada!', 'Voc√™ saiu da sala de consulta', 'info');
            }
            showRoomSelection();
        }

        async function sendRoomMessage() {
            const input = document.getElementById('roomMessageInput');
            const text = input.value.trim();
            
            if (!text) return;
            
            if (!currentRoom) {
                showNotification('Erro!', 'Nenhuma sala selecionada', 'error');
                return;
            }
            
            addRoomMessage(text, true, 'Voc√™');
            input.value = '';
            
            // Show typing indicator
            const typingId = addTypingIndicator();
            
            // Dados dos especialistas por sala
            const roomData = {
                'geral': 'Dr. Cl√≠nico Geral',
                'cardio': 'Dr. Cardiologista', 
                'derma': 'Dr. Dermatologista'
            };
            
            console.log(`üè• Enviando pergunta para sala: ${currentRoom} (${roomData[currentRoom]})`);
            
            try {
                const response = await getAISpecialistResponse(text, currentRoom);
                removeTypingIndicator(typingId);
                
                console.log(`‚úÖ Resposta recebida do ${roomData[currentRoom]}`);
                addRoomMessage(response, false, roomData[currentRoom]);
                
            } catch (error) {
                removeTypingIndicator(typingId);
                console.error(`‚ùå Erro ao obter resposta para sala ${currentRoom}:`, error);
                
                // Fallback responses espec√≠ficos por especialidade
                const fallbackResponses = {
                    'geral': [
                        'Ol√°! Sou o Dr. Cl√≠nico Geral. Entendo sua preocupa√ß√£o. Pode me dar mais detalhes sobre os sintomas, quando come√ßaram e sua intensidade?',
                        'Como Dr. Cl√≠nico Geral com 15 anos de experi√™ncia, baseado no que descreveu, seria importante fazer uma avalia√ß√£o mais detalhada. H√° quanto tempo sente isso?',
                        'Sou o Dr. Cl√≠nico Geral. Vou anotar essas informa√ß√µes importantes. Tem hist√≥rico familiar de doen√ßas? Toma algum medicamento?',
                        'Como Dr. Cl√≠nico Geral, posso ajudar com diversos problemas de sa√∫de. Me conte mais sobre seu hist√≥rico m√©dico e sintomas atuais.'
                    ],
                    'cardio': [
                        'Ol√°! Sou o Dr. Cardiologista. Quest√µes do cora√ß√£o requerem aten√ß√£o especial. Me conte mais sobre dor no peito, palpita√ß√µes ou falta de ar.',
                        'Como Dr. Cardiologista com 12 anos de experi√™ncia, vamos investigar sua sa√∫de cardiovascular. Tem hist√≥rico familiar de problemas card√≠acos?',
                        'Sou o Dr. Cardiologista. √â importante monitorar esses sintomas card√≠acos. Qual sua press√£o arterial habitual? Faz exerc√≠cios regularmente?',
                        'Como Dr. Cardiologista, press√£o arterial, colesterol e ritmo card√≠aco s√£o fundamentais. Quando foi seu √∫ltimo eletrocardiograma?'
                    ],
                    'derma': [
                        'Ol√°! Sou o Dr. Dermatologista. Problemas de pele podem ter v√°rias causas. Pode descrever melhor a les√£o: cor, tamanho, localiza√ß√£o?',
                        'Como Dr. Dermatologista com 10 anos de experi√™ncia, vou examinar essa quest√£o. Quando come√ßou a notar essas altera√ß√µes na pele?',
                        'Sou o Dr. Dermatologista. Para cuidados com a pele, preciso entender melhor. H√° coceira, dor, descama√ß√£o ou mudan√ßa de cor?',
                        'Como Dr. Dermatologista, pele, cabelo e unhas s√£o minha especialidade. Me conte sobre exposi√ß√£o solar e hist√≥rico dermatol√≥gico.'
                    ]
                };
                
                const responses = fallbackResponses[currentRoom] || fallbackResponses['geral'];
                const fallbackResponse = responses[Math.floor(Math.random() * responses.length)];
                
                console.log(`üîÑ Usando resposta fallback para ${currentRoom}: ${roomData[currentRoom]}`);
                addRoomMessage(fallbackResponse, false, roomData[currentRoom]);
            }
        }

        function addRoomMessage(text, isUser, sender) {
            const messagesArea = document.getElementById('roomMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message-bubble ${isUser ? 'ml-auto bg-purple-600' : 'bg-gray-700'} p-3 rounded-xl max-w-xs`;
            
            const time = new Date().toLocaleTimeString('pt-BR', {
                hour: '2-digit',
                minute: '2-digit'
            });
            
            messageDiv.innerHTML = `
                <p class="text-sm">${text}</p>
                <span class="text-xs text-gray-400">${sender} ‚Ä¢ ${time}</span>
            `;
            
            messagesArea.appendChild(messageDiv);
            messagesArea.scrollTop = messagesArea.scrollHeight;
        }

        // FUN√á√ïES COMPLETAMENTE FUNCIONAIS
        function scrollToServices() {
            document.getElementById('services').scrollIntoView({ behavior: 'smooth' });
        }

        function toggleAutoChat() {
            const autoChatContainer = document.getElementById('autoChatContainer');
            autoChatOpen = !autoChatOpen;
            
            if (autoChatOpen) {
                autoChatContainer.classList.add('open');
                showNotification('Autoatendimento ativo!', 'Assistente m√©dico virtual conectado', 'success');
            } else {
                autoChatContainer.classList.remove('open');
            }
        }

        function toggleChat() {
            const chatContainer = document.getElementById('chatContainer');
            chatOpen = !chatOpen;
            
            if (chatOpen) {
                chatContainer.classList.add('open');
                initializeLiveChat();
                showNotification('Chat m√©dico ativo!', '2 m√©dicos online para ajudar', 'success');
            } else {
                chatContainer.classList.remove('open');
            }
        }

        function toggleNutritionChat() {
            const nutritionContainer = document.getElementById('nutritionChatContainer');
            const isOpen = nutritionContainer.classList.contains('open');
            
            if (!isOpen) {
                nutritionContainer.classList.add('open');
                showNotification('Dr. Nutricionista online!', 'Dra. Ana pronta para ajudar', 'success');
            } else {
                nutritionContainer.classList.remove('open');
            }
        }

        function closeNutritionChat() {
            document.getElementById('nutritionChatContainer').classList.remove('open');
        }

        function togglePsychologyChat() {
            const psychologyContainer = document.getElementById('psychologyChatContainer');
            const isOpen = psychologyContainer.classList.contains('open');
            
            if (!isOpen) {
                psychologyContainer.classList.add('open');
                showNotification('Dr. Psic√≥logo online!', 'Dr. Carlos especialista em v√≠cios', 'success');
            } else {
                psychologyContainer.classList.remove('open');
            }
        }

        function closePsychologyChat() {
            document.getElementById('psychologyChatContainer').classList.remove('open');
        }

        function togglePharmacyFinder() {
            const pharmacyContainer = document.getElementById('pharmacyContainer');
            pharmacyOpen = !pharmacyOpen;
            
            if (pharmacyOpen) {
                pharmacyContainer.classList.add('open');
                initializePharmacyMap();
                showNotification('Farm√°cias localizadas!', 'Encontre medicamentos em Caruaru', 'success');
            } else {
                pharmacyContainer.classList.remove('open');
            }
        }

        function toggleConsultation() {
            const consultationContainer = document.getElementById('consultationContainer');
            consultationOpen = !consultationOpen;
            
            if (consultationOpen) {
                consultationContainer.classList.add('open');
                showRoomSelection();
                showNotification('Salas abertas!', '3 especialistas dispon√≠veis', 'success');
            } else {
                consultationContainer.classList.remove('open');
                leaveRoom();
            }
        }

        // FUN√á√ïES COMPLETAMENTE FUNCIONAIS
        function searchByAddress() {
            const locationInput = document.getElementById('locationInput');
            const location = locationInput.value.trim();
            
            if (!location) {
                showNotification('Digite um local!', 'Informe um bairro de Caruaru-PE', 'warning');
                return;
            }
            
            searchPharmaciesInCaruaru(location);
        }

        function useCurrentLocation() {
            if (!navigator.geolocation) {
                showNotification('GPS n√£o dispon√≠vel!', 'Seu navegador n√£o suporta geolocaliza√ß√£o', 'error');
                return;
            }
            
            showNotification('Localizando...', 'Obtendo sua localiza√ß√£o atual', 'info');
            
            navigator.geolocation.getCurrentPosition(
                (position) => {
                    const lat = position.coords.latitude;
                    const lng = position.coords.longitude;
                    userLocation = { lat, lng };
                    
                    showNotification('Localiza√ß√£o obtida!', 'Buscando farm√°cias pr√≥ximas', 'success');
                    searchNearbyPharmacies(lat, lng);
                },
                (error) => {
                    showNotification('Erro de GPS!', 'N√£o foi poss√≠vel obter sua localiza√ß√£o', 'error');
                    console.error('Erro de geolocaliza√ß√£o:', error);
                }
            );
        }

        function clickOnMap() {
            showNotification('Mapa ativo!', 'Clique no mapa para buscar farm√°cias na regi√£o', 'info');
            initializeInteractiveMap();
        }

        async function sendAutoMessage() {
            const input = document.getElementById('autoMessageInput');
            const text = input.value.trim();
            
            if (!text) return;
            
            addAutoMessage(text, true, 'Voc√™');
            input.value = '';
            
            // Simular resposta do bot
            setTimeout(() => {
                const responses = [
                    'Entendo sua preocupa√ß√£o. Pode me dar mais detalhes sobre os sintomas?',
                    'Baseado no que descreveu, recomendo agendar uma consulta com nosso cl√≠nico geral.',
                    'Para sintomas como esses, √© importante fazer uma avalia√ß√£o m√©dica adequada.',
                    'Posso ajudar a agendar uma consulta ou conect√°-lo com um de nossos especialistas.',
                    'Vou anotar essas informa√ß√µes. Gostaria de falar com um m√©dico agora?'
                ];
                
                const response = responses[Math.floor(Math.random() * responses.length)];
                addAutoMessage(response, false, 'Assistente Virtual');
            }, 1500);
        }

        async function sendRoomMessage() {
            const input = document.getElementById('roomMessageInput');
            const text = input.value.trim();
            
            if (!text) return;
            
            if (!currentRoom) {
                showNotification('Erro!', 'Nenhuma sala selecionada', 'error');
                return;
            }
            
            addRoomMessage(text, true, 'Voc√™');
            input.value = '';
            
            // Show typing indicator
            const typingId = addTypingIndicator();
            
            try {
                const response = await getAISpecialistResponse(text, currentRoom);
                removeTypingIndicator(typingId);
                
                const roomData = {
                    'geral': 'Dr. Cl√≠nico Geral',
                    'cardio': 'Dr. Cardiologista', 
                    'derma': 'Dr. Dermatologista'
                };
                
                addRoomMessage(response, false, roomData[currentRoom]);
                
            } catch (error) {
                removeTypingIndicator(typingId);
                console.error('Erro ao obter resposta:', error);
                
                const fallbackResponse = 'Desculpe, estou com dificuldades t√©cnicas no momento. Pode repetir sua pergunta?';
                addRoomMessage(fallbackResponse, false, 'M√©dico');
            }
        }

        async function sendNutritionChatMessage() {
            const input = document.getElementById('nutritionMessageInput');
            const text = input.value.trim();
            
            if (!text) return;
            
            addNutritionMessage(text, true, 'Voc√™');
            input.value = '';
            
            // Simular resposta da nutricionista
            setTimeout(() => {
                const responses = [
                    '√ìtima pergunta sobre nutri√ß√£o! Para uma dieta equilibrada, recomendo incluir mais vegetais e prote√≠nas magras.',
                    'Baseado no que descreveu, vamos ajustar seu plano alimentar. Quantas refei√ß√µes faz por dia?',
                    'Para seus objetivos nutricionais, √© importante manter hidrata√ß√£o adequada e hor√°rios regulares.',
                    'Vou criar um plano personalizado para voc√™. Tem alguma restri√ß√£o alimentar ou alergia?',
                    'Excelente! Nutri√ß√£o √© fundamental para sa√∫de. Vamos trabalhar juntos seus h√°bitos alimentares.'
                ];
                
                const response = responses[Math.floor(Math.random() * responses.length)];
                addNutritionMessage(response, false, 'Dra. Ana - Nutricionista');
            }, 2000);
        }

        async function sendPsychologyChatMessage() {
            const input = document.getElementById('psychologyMessageInput');
            const text = input.value.trim();
            
            if (!text) return;
            
            addPsychologyMessage(text, true, 'Voc√™');
            input.value = '';
            
            // Simular resposta do psic√≥logo
            setTimeout(() => {
                const responses = [
                    'Entendo como se sente. Vamos trabalhar juntos essas quest√µes. Pode me contar mais sobre quando isso come√ßou?',
                    '√â normal sentir-se assim. Como psic√≥logo especialista em v√≠cios, posso ajudar com estrat√©gias eficazes.',
                    'Obrigado por compartilhar isso comigo. Vamos desenvolver t√©cnicas para lidar com essa situa√ß√£o.',
                    'Seus sentimentos s√£o v√°lidos. Que tal explorarmos algumas t√©cnicas de enfrentamento?',
                    'Estou aqui para apoi√°-lo. Juntos podemos encontrar caminhos para superar esses desafios.'
                ];
                
                const response = responses[Math.floor(Math.random() * responses.length)];
                addPsychologyMessage(response, false, 'Dr. Carlos - Psic√≥logo');
            }, 2500);
        }

        // FUN√á√ïES AUXILIARES PARA CHATS
        function addAutoMessage(text, isUser, sender) {
            const messagesArea = document.getElementById('autoMessagesArea');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message-bubble ${isUser ? 'ml-auto bg-green-600' : 'bg-gray-700'} p-3 rounded-xl max-w-xs`;
            
            const time = new Date().toLocaleTimeString('pt-BR', {
                hour: '2-digit',
                minute: '2-digit'
            });
            
            messageDiv.innerHTML = `
                <p class="text-sm">${text}</p>
                <span class="text-xs text-gray-400">${sender} ‚Ä¢ ${time}</span>
            `;
            
            messagesArea.appendChild(messageDiv);
            messagesArea.scrollTop = messagesArea.scrollHeight;
        }

        function addNutritionMessage(text, isUser, sender) {
            const messagesArea = document.getElementById('nutritionMessagesArea');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message-bubble ${isUser ? 'ml-auto bg-green-600' : 'bg-gray-700'} p-3 rounded-xl max-w-xs`;
            
            const time = new Date().toLocaleTimeString('pt-BR', {
                hour: '2-digit',
                minute: '2-digit'
            });
            
            messageDiv.innerHTML = `
                <p class="text-sm">${text}</p>
                <span class="text-xs text-gray-400">${sender} ‚Ä¢ ${time}</span>
            `;
            
            messagesArea.appendChild(messageDiv);
            messagesArea.scrollTop = messagesArea.scrollHeight;
        }

        function addPsychologyMessage(text, isUser, sender) {
            const messagesArea = document.getElementById('psychologyMessagesArea');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message-bubble ${isUser ? 'ml-auto bg-purple-600' : 'bg-gray-700'} p-3 rounded-xl max-w-xs`;
            
            const time = new Date().toLocaleTimeString('pt-BR', {
                hour: '2-digit',
                minute: '2-digit'
            });
            
            messageDiv.innerHTML = `
                <p class="text-sm">${text}</p>
                <span class="text-xs text-gray-400">${sender} ‚Ä¢ ${time}</span>
            `;
            
            messagesArea.appendChild(messageDiv);
            messagesArea.scrollTop = messagesArea.scrollHeight;
        }

        // FUN√á√ïES DE FARM√ÅCIA
        function searchPharmaciesInCaruaru(location) {
            const pharmacyResults = document.getElementById('pharmacyResults');
            const locationLower = location.toLowerCase();
            
            showNotification('Buscando farm√°cias...', `Procurando em ${location}`, 'info');
            
            const pharmacies = {
                'centro': [
                    { name: 'Farm√°cia Central', address: 'Rua 15 de Novembro, 123', phone: '(87) 3721-1234', distance: '0.2 km' },
                    { name: 'Drogaria S√£o Paulo', address: 'Av. Agamenon Magalh√£es, 456', phone: '(87) 3721-5678', distance: '0.5 km' },
                    { name: 'Farm√°cia Pague Menos', address: 'Rua Vig√°rio Freire, 789', phone: '(87) 3721-9012', distance: '0.8 km' }
                ],
                'universit√°rio': [
                    { name: 'Farm√°cia Universit√°ria', address: 'Av. Universit√°ria, 321', phone: '(87) 3722-1111', distance: '0.3 km' },
                    { name: 'Drogasil', address: 'Rua dos Estudantes, 654', phone: '(87) 3722-2222', distance: '0.6 km' },
                    { name: 'Farm√°cia Popular', address: 'Av. Brasil, 987', phone: '(87) 3722-3333', distance: '1.0 km' }
                ],
                'kennedy': [
                    { name: 'Farm√°cia Kennedy', address: 'Av. Kennedy, 111', phone: '(87) 3723-4444', distance: '0.4 km' },
                    { name: 'Drogaria Pacheco', address: 'Rua JK, 222', phone: '(87) 3723-5555', distance: '0.7 km' },
                    { name: 'Farm√°cia Nissei', address: 'Av. das Am√©ricas, 333', phone: '(87) 3723-6666', distance: '1.2 km' }
                ]
            };
            
            let results = [];
            
            // Buscar por bairro espec√≠fico
            for (const [bairro, farmaciasList] of Object.entries(pharmacies)) {
                if (locationLower.includes(bairro)) {
                    results = farmaciasList;
                    break;
                }
            }
            
            // Se n√£o encontrou por bairro, buscar em todas
            if (results.length === 0) {
                results = Object.values(pharmacies).flat().slice(0, 5);
            }
            
            displayPharmacyResults(results);
        }

        function displayPharmacyResults(pharmacies) {
            const pharmacyResults = document.getElementById('pharmacyResults');
            
            let html = '<div class="space-y-3">';
            
            pharmacies.forEach(pharmacy => {
                html += `
                    <div class="bg-gray-800 rounded-lg p-3 border border-gray-600">
                        <div class="flex items-start justify-between">
                            <div class="flex-1">
                                <h6 class="font-semibold text-white mb-1">${pharmacy.name}</h6>
                                <p class="text-xs text-gray-400 mb-2">${pharmacy.address}</p>
                                <div class="flex items-center space-x-4 text-xs">
                                    <span class="text-green-400">üìû ${pharmacy.phone}</span>
                                    <span class="text-blue-400">üìç ${pharmacy.distance}</span>
                                </div>
                            </div>
                            <button onclick="callPharmacy('${pharmacy.phone}')" class="bg-green-600 hover:bg-green-700 px-3 py-1 rounded text-xs transition">
                                Ligar
                            </button>
                        </div>
                    </div>
                `;
            });
            
            html += '</div>';
            pharmacyResults.innerHTML = html;
            
            showNotification('Farm√°cias encontradas!', `${pharmacies.length} farm√°cias na regi√£o`, 'success');
        }

        function callPharmacy(phone) {
            window.open(`tel:${phone}`, '_self');
            showNotification('Ligando...', `Conectando com ${phone}`, 'info');
        }

        function searchNearbyPharmacies(lat, lng) {
            // Simular busca por GPS
            const nearbyPharmacies = [
                { name: 'Farm√°cia Mais Pr√≥xima', address: 'Localizada via GPS', phone: '(87) 3721-0000', distance: '0.1 km' },
                { name: 'Drogaria 24h', address: 'Aberta 24 horas', phone: '(87) 3721-2424', distance: '0.3 km' },
                { name: 'Farm√°cia Popular', address: 'Pre√ßos populares', phone: '(87) 3721-1000', distance: '0.5 km' }
            ];
            
            displayPharmacyResults(nearbyPharmacies);
        }

        function initializePharmacyMap() {
            const mapPlaceholder = document.getElementById('mapPlaceholder');
            mapPlaceholder.innerHTML = `
                <div class="w-full h-full bg-green-100 rounded-lg flex items-center justify-center cursor-pointer" onclick="showMapInteraction()">
                    <div class="text-center text-green-800">
                        <div class="text-2xl mb-2">üó∫Ô∏è</div>
                        <p class="text-sm font-semibold">Mapa de Caruaru</p>
                        <p class="text-xs">Clique para interagir</p>
                    </div>
                </div>
            `;
        }

        function showMapInteraction() {
            showNotification('Mapa ativo!', 'Funcionalidade de mapa em desenvolvimento', 'info');
        }

        function initializeInteractiveMap() {
            initializePharmacyMap();
        }

        function initializeLiveChat() {
            const messagesArea = document.getElementById('messagesArea');
            messagesArea.innerHTML = `
                <div class="message-bubble bg-gray-700 p-3 rounded-xl max-w-xs">
                    <p class="text-sm">üëã Ol√°! Bem-vindo ao chat m√©dico ao vivo. Como posso ajudar?</p>
                    <span class="text-xs text-gray-400">Dr. M√©dico ‚Ä¢ agora</span>
                </div>
            `;
        }

        function sendMessage() {
            const input = document.getElementById('messageInput');
            const text = input.value.trim();
            
            if (!text) return;
            
            const messagesArea = document.getElementById('messagesArea');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message-bubble ml-auto bg-blue-600 p-3 rounded-xl max-w-xs';
            
            const time = new Date().toLocaleTimeString('pt-BR', {
                hour: '2-digit',
                minute: '2-digit'
            });
            
            messageDiv.innerHTML = `
                <p class="text-sm">${text}</p>
                <span class="text-xs text-gray-400">Voc√™ ‚Ä¢ ${time}</span>
            `;
            
            messagesArea.appendChild(messageDiv);
            messagesArea.scrollTop = messagesArea.scrollHeight;
            input.value = '';
            
            // Simular resposta m√©dica
            setTimeout(() => {
                const responses = [
                    'Entendo sua situa√ß√£o. Pode me dar mais detalhes sobre os sintomas?',
                    'Baseado no que descreveu, vou encaminhar para o especialista adequado.',
                    '√â importante fazer uma avalia√ß√£o presencial. Posso agendar uma consulta?',
                    'Vou anotar essas informa√ß√µes no seu prontu√°rio. Mais alguma d√∫vida?'
                ];
                
                const response = responses[Math.floor(Math.random() * responses.length)];
                const responseDiv = document.createElement('div');
                responseDiv.className = 'message-bubble bg-gray-700 p-3 rounded-xl max-w-xs';
                responseDiv.innerHTML = `
                    <p class="text-sm">${response}</p>
                    <span class="text-xs text-gray-400">Dr. M√©dico ‚Ä¢ ${time}</span>
                `;
                
                messagesArea.appendChild(responseDiv);
                messagesArea.scrollTop = messagesArea.scrollHeight;
            }, 2000);
        }

        function sendImage() {
            showNotification('Imagem enviada!', 'Foto enviada para an√°lise m√©dica', 'success');
        }

        function handleMainAction() {
            const messageInput = document.getElementById('messageInput');
            if (messageInput.value.trim()) {
                sendMessage();
            } else {
                showNotification('√Åudio ativo!', 'Funcionalidade de √°udio em desenvolvimento', 'info');
            }
        }

        // INICIALIZA√á√ÉO SIMPLES
        document.addEventListener('DOMContentLoaded', function() {
            console.log('‚úÖ Cl√≠nica Digital Pro carregada!');
            
            // Solicitar permiss√£o para notifica√ß√µes
            if ('Notification' in window && Notification.permission === 'default') {
                Notification.requestPermission();
            }
            
            // Verificar APIs
            checkApiKeys();
            
            showNotification('Bem-vindo!', 'Cl√≠nica Digital Pro est√° online', 'success');
        });

        // ENTER KEY HANDLERS
        document.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                if (e.target.id === 'symptomsInput') {
                    analyzeSymptoms();
                } else if (e.target.id === 'messageInput') {
                    sendMessage();
                } else if (e.target.id === 'autoMessageInput') {
                    sendAutoMessage();
                } else if (e.target.id === 'roomMessageInput') {
                    sendRoomMessage();
                } else if (e.target.id === 'nutritionMessageInput') {
                    sendNutritionChatMessage();
                } else if (e.target.id === 'psychologyMessageInput') {
                    sendPsychologyChatMessage();
                }
            }
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'98197dc654c5cad8',t:'MTc1ODI4OTE4OS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
